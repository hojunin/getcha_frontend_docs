<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-post-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/getcha_frontend_docs/blog/rss.xml" title="🚘 겟차 프론트엔드 챕터입니다 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/getcha_frontend_docs/blog/atom.xml" title="🚘 겟차 프론트엔드 챕터입니다 Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GED69DZF72"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GED69DZF72",{})</script><title data-rh="true">라이브러리에 문제가 생겼어요. | 🚘 겟차 프론트엔드 챕터입니다</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hojunin.github.io/getcha_frontend_docs/blog/library"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docusaurus_tag" content="default"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="docsearch:docusaurus_tag" content="default"><meta data-rh="true" name="Keywords" content="겟차, 프론트엔드, 겟차 프론트엔드"><meta data-rh="true" property="og:title" content="라이브러리에 문제가 생겼어요. | 🚘 겟차 프론트엔드 챕터입니다"><meta data-rh="true" name="description" content="안녕하세요. Getcha 프론트엔드 개발자 Nick입니다 😆"><meta data-rh="true" property="og:description" content="안녕하세요. Getcha 프론트엔드 개발자 Nick입니다 😆"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2022-06-25T00:00:00.000Z"><meta data-rh="true" property="article:author" content="https://github.com/hojunin"><meta data-rh="true" property="article:tag" content="react-native"><link data-rh="true" rel="icon" href="/getcha_frontend_docs/img/getcha_favicon.ico"><link data-rh="true" rel="canonical" href="https://hojunin.github.io/getcha_frontend_docs/blog/library"><link data-rh="true" rel="alternate" href="https://hojunin.github.io/getcha_frontend_docs/blog/library" hreflang="en"><link data-rh="true" rel="alternate" href="https://hojunin.github.io/getcha_frontend_docs/blog/library" hreflang="x-default"><link rel="stylesheet" href="/getcha_frontend_docs/assets/css/styles.f9ae1b58.css">
<link rel="preload" href="/getcha_frontend_docs/assets/js/runtime~main.625e365d.js" as="script">
<link rel="preload" href="/getcha_frontend_docs/assets/js/main.79479b78.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/getcha_frontend_docs/"><div class="navbar__logo"><img src="/getcha_frontend_docs/img/getcha_logo.svg" alt="Getcha_Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/getcha_frontend_docs/img/getcha_logo.svg" alt="Getcha_Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">겟차 프론트엔드 챕터</b></a><a class="navbar__item navbar__link" href="/getcha_frontend_docs/docs/intro">앱</a><a class="navbar__item navbar__link" href="/getcha_frontend_docs/utils-docs/intro">유틸</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/getcha_frontend_docs/blog">블로그</a></div><div class="navbar__items navbar__items--right"><a href="https://www.npmjs.com/package/getcha-react-ui-components" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">겟차 UI Components<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/git">겟차의 깃 전략을 소개합니다!</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/react">리액트 쿼리, 효과적으로 활용해보자.</a></li><li class="sidebarItem_CF0Q"><a aria-current="page" class="sidebarItemLink_miNk sidebarItemLinkActive_RRTD" href="/getcha_frontend_docs/blog/library">라이브러리에 문제가 생겼어요.</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/modal">겟차에서 모달을 컨트롤하는 방법</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/team-blog">도큐사우루스를 활용한 겟차 프론트엔드 팀 사이트 만들기</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h1 class="blogPostTitle_rzP5" itemprop="headline">라이브러리에 문제가 생겼어요.</h1><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-06-25T00:00:00.000Z" itemprop="datePublished">June 25, 2022</time> · <!-- -->21 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18079523?v=4" alt="Nick"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nick</span></a></div><small class="avatar__subtitle" itemprop="description">FrontEnd Developer</small></div></div></div></div></header><div id="post-content" class="markdown" itemprop="articleBody"><p>안녕하세요. Getcha 프론트엔드 개발자 <strong>Nick</strong>입니다 😆</p><p>이번 겟차 &amp; 현대캐피탈 라이브쇼 준비 과정에서 발생했던 이슈를 해결했던 과정을 공유 드리려고해요. 이 과정에서 <em>서드파티 라이브러리</em>에 대한 관점이 바뀌었고, <em>비슷한 문제가 발생했을 때</em> 어떻게 대응해야하는지 생각해볼 필요가 있겠다는 생각에 이 회고의 글을 남깁니다.</p><p>사건의 발단은 웹에서 <code>iframe</code>을 활용해 임베딩한 <code>video</code> 태그가 Android에서는 잘 동작하는데, <strong>IOS에서 네이티브 플레이어로 풀스크린 재생이 되는 문제</strong>가 발견되면서 부터였습니다. 영상이 재생되긴 하니까 크리티컬하지 않다고 생각했는데, 생각해보니 비디오만 보일 뿐이지 라이브쇼 솔루션 개발사에서 제공하는 <strong>채팅</strong>이나 <strong>구매 플로우</strong>같은 핵심 UI를 IOS 네이티브 플레이어가 덮어버려서 꼭 해결해야겠다고 생각했습니다.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="뭐가-문제였을까">뭐가 문제였을까<a class="hash-link" href="#뭐가-문제였을까" title="Direct link to heading">​</a></h2><p>저희는 Native 앱이 아닌 <strong>React Native</strong>를 활용하고, 이 프로젝트는 <strong>WebView</strong>로 구현해둔 상태였습니다. 즉, 연결다리가 많다보니 어디가 문제인지 확실히 알 수 없어 디버깅에 하루를 통째로 갈아넣었던 것 같아요. 조금은 무식하지만 저는 문제가 될 수 있는 부분들을 전부 까보기로 했습니다. (본격 돌다리 두들기기)</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>문제의 구조</h5></div><div class="admonition-content"><p><img loading="lazy" alt="문제의 구조" src="/getcha_frontend_docs/assets/images/structure-3b20f993fae81ec0eb8fb7e7aefe797f.png" width="1694" height="744" class="img_E7b_"></p><p>당시의 상황은 위 사진과 같습니다.</p><p>그래서 다음의 모든 경우의 수에서 에러가 발생할 수 있으므로, 전부 확인해야 했습니다.</p><ul><li>네이티브 앱 레벨</li><li>React Native &amp; JavaScript 레벨</li><li>브릿지 역할을 하는 라이브러리</li><li>Webview용 웹페이지</li><li>라이브쇼 솔루션 회사 제품</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="라이브쇼-솔루션">라이브쇼 솔루션<a class="hash-link" href="#라이브쇼-솔루션" title="Direct link to heading">​</a></h3><p>먼저 가장 빨리 확인할 수 있는 라이브쇼 솔루션을 체크했습니다. 간단한 property만 체크하면 되고, 문제 없으면 이제 <strong>저희 문제</strong>만 확인하면 되니까요. 여기서 제공하는 사이트를 임베딩해서 쓰는 방식이었으므로 간단히 element만 확인해봤습니다. 예상대로 <code>video</code> 태그와 <code>div</code> 태그들 뿐이었습니다.</p><p><img loading="lazy" alt="1" src="/getcha_frontend_docs/assets/images/1-837895786dd7ec4b40036ce11b521150.png" width="756" height="678" class="img_E7b_"></p><p><code>vidoe</code> tag의 property 중에 <code>playsinline</code>이라는 값이 있는데, 이 값이 중요합니다. true로 되어있는지를 확인해야 했거든요. 이 값이 true가 아니면, video 태그가 네이티브 플레이어로 재생됩니다. 보시는대로, 솔루션 업체는 명확하게 이 값을 true로 지정해 두었습니다. 즉, 솔루션쪽은 전혀 문제가 없다고 판단했습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="웹">웹<a class="hash-link" href="#웹" title="Direct link to heading">​</a></h3><p>다음은 웹에서 <code>iframe</code>으로 라이브쇼 솔루션을 임베딩하는 코드를 살펴봤습니다. 사실 이 부분은 볼 필요가 없었던게, <code>iframe</code>으로 솔루션 업체에서 제공하는 url을 임베딩하는 코드 말고는 없다고 봐도 무방했기 때문에, 몇몇 불필요한 property가 있는지만 확인했습니다.</p><p><img loading="lazy" alt="2" src="/getcha_frontend_docs/assets/images/2-34e4f2b801dc06ba54b6a5a3c8fde9a0.png" width="1646" height="1138" class="img_E7b_"></p><p>공식문서를 확인해보니, <code>allowFullscreen</code>같은 property가 있었는데, 이 문제를 해결하는데에는 효과가 없었습니다. 그래서 웹도 큰 문제가 없다고 판단했습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="앱react-native">앱(React Native)<a class="hash-link" href="#앱react-native" title="Direct link to heading">​</a></h3><p>앱에서는 <code>react-native-webview</code>라는 라이브러리를 통해 네이티브 웹뷰 클래스를 호출해 웹으로 만든 사이트를 띄우도록 되어 있어요. 문제가 있다면 라이브러리에 특정 기능을 활용하지 않아서라고 생각하고, <a href="https://github.com/react-native-webview/react-native-webview/blob/master/docs/Reference.md#allowsinlinemediaplayback" target="_blank" rel="noopener noreferrer">라이브러리 공식문서</a>를 살펴봤습니다.</p><p><img loading="lazy" alt="3" src="/getcha_frontend_docs/assets/images/3-6ee6ee4319e4271f17129759f328996b.png" width="1832" height="512" class="img_E7b_"></p><blockquote><p>찾았다 요놈!</p></blockquote><p>쭉쭉 내리다 보니 제가 찾고있던 property가 딱 있었습니다. property 이름에서 느낌이 와닿지 않아 찾는데 시간이 좀 걸렸습니다. ㅠ</p><p>그럼 이 값을 true로 주면 당연히 되겠지 했는데,</p><p><img loading="lazy" alt="wtf" src="/getcha_frontend_docs/assets/images/4-e922d1aa667d3b0364672ca8e850ad32.jpeg" width="613" height="533" class="img_E7b_"></p><p>무슨 이유인지 실행해보니 <strong>동작하지 않았습니다</strong>. 왜 이 때 라이브러리가 잘못되었다고 생각하지 않았는지 후 ..</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="앱네이티브---ios">앱(네이티브 - IOS)<a class="hash-link" href="#앱네이티브---ios" title="Direct link to heading">​</a></h3><p>일단 문제는 해결해야겠으니, 마지막으로 네이티브 레벨로 내려왔습니다.</p><p>다행히 이 이슈가 React Native 레벨 문제라고 하더라도, 실행 로직이 아니다보니 가장 낮은 레벨인 Native 레벨에서 configuration 정도는 강제로 변경할 수 있다고 생각했습니다.</p><p>React Native에서 Native Module을 활용하는 라이브러리는 IOS의 Pods에서 관리됩니다. objective-c로 작성되어 있는데, RN 레벨에서는 확장자가 .h인 <strong>header 파일</strong>만 존재하고, Native 레벨에서는 확장자가 .m인 <strong>구현체 파일</strong>까지 존재합니다.</p><p>.h 파일은 사용할 변수나 메소드를 정의하고, .m은 이를 바탕으로 변수 및 get, set 메소드를 자동생성해줍니다. 저는 이 중에서 제가 필요한 property인 <code>allowsInlinePlayback</code>이라는 변수를 set하는 메소드가 동작하지 않는다고 가정하고, assignment 부분을 initialize처럼 동작하도록 강제했습니다.</p><p>아래는 이와 관련된 깃 이슈에 올린 솔루션입니다.</p><p><img loading="lazy" alt="5" src="/getcha_frontend_docs/assets/images/5-d5beb7a83d75372af9e395c54b25f480.png" width="1672" height="1194" class="img_E7b_"></p><p>이렇게 수정한 결과, 문제없이 동작했습니다. 해결한 다음날이 라이브쇼 첫방송이다보니 퇴근 직전에 문제 해결하고 긴장이 쫙 풀렸던 기억이 납니다. 😵‍💫</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="알고보니-라이브러리가-문제였다">알고보니 라이브러리가 문제였다.<a class="hash-link" href="#알고보니-라이브러리가-문제였다" title="Direct link to heading">​</a></h2><p>당장 급한 불을 껐으니, 진짜 문제를 해결하기 위해 마지막으로 라이브러리를 확인해봤습니다.</p><p><code>react-native-webview</code>는 react-native에서 비공식이지만 권장하는 webview 기능이기 때문에 오류가 있을 것이라고는 상상도 못했습니다. <code>react-native-webview</code> 깃허브에 이슈를 확인해보니 <a href="https://github.com/react-native-webview/react-native-webview/issues/2544" target="_blank" rel="noopener noreferrer">비슷한 이슈</a>가 있어 comment를 남기고 소통을 시도했지만 별 소용이 없었어요.</p><p><img loading="lazy" alt="6" src="/getcha_frontend_docs/assets/images/6-4c7f24d489334a106a58f65008d50b55.png" width="1826" height="300" class="img_E7b_"></p><blockquote><p>공허하다..</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="그럼-직접-까보자">그럼 직접 까보자<a class="hash-link" href="#그럼-직접-까보자" title="Direct link to heading">​</a></h3><p>사실 거의 공식 라이브러리다보니 문제가 있을거라는 <strong>의심</strong>도 없었고, 해결할 것이라고는 <strong>기대</strong>도 하지 않았습니다. 그래서 마지막에 확인했던 것이었어요.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>react-native의 커뮤니티급 라이브러리</h5></div><div class="admonition-content"><p>이런 커뮤니티급 라이브러리는 보통 React Native로 Android나 IOS 네이티브 코드를 조작하는 라이브러리입니다. 가령 <code>react-native-webview</code>는 Android Webview클래스와 IOS의 WKWebview 클래스를 직접 조작해요. 아래 사진과 같이 동작합니다.</p><p><img loading="lazy" alt="7" src="/getcha_frontend_docs/assets/images/7-f048b7bad62c4439e40977d96dc641a8.png" width="1156" height="404" class="img_E7b_"></p><p>즉, 목적이 React Native 개발자가 WebView같은 네이티브 클래스를 네이티브 코드 조작 없이 다룰 수 있게하는 라이브러리입니다.</p><p><img loading="lazy" alt="18" src="/getcha_frontend_docs/assets/images/18-d03e656998d6f1434e1a5569bc3899ef.png" width="1716" height="302" class="img_E7b_"></p><p>위 사진과 같이 리액트 네이티브에서는 기본으로 제공하던 기능을 특정 기능을 모듈로 분리해 <strong>커뮤니티급 라이브러리</strong>로 관리합니다. React Native 공식 홈페이지를 보면 위와 같이 안내하므로, 비공식이지만 <strong>기본 제공 기능</strong>처럼 활용하곤 합니다.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="코드-부검-시작">코드 부검 시작!<a class="hash-link" href="#코드-부검-시작" title="Direct link to heading">​</a></h3><p>먼저 React Native단에서 넘겨주는 property를 확인했습니다. 문서에 적힌대로 대부분 잘 받아오는 것을 볼 수 있었습니다.</p><p><img loading="lazy" alt="8" src="/getcha_frontend_docs/assets/images/8-73e9cef6c99981b2dd12d5bc94b35343.png" width="1118" height="1312" class="img_E7b_"></p><p>아래 사진은 위에서 받아온 props를 여차저차 가공을 하거나 그대로 받아서 실제 Native Module의 Webview 클래스 구현체를 만드는 과정입니다.</p><p><img loading="lazy" alt="9" src="/getcha_frontend_docs/assets/images/9-dc1655568d142fd62939f62660545bc2.png" width="1420" height="1218" class="img_E7b_"></p><p>잘 보면, 위에서 받아온 property 몇개가 아래로 전달이 안되고 있었습니다. 저는 당연히 제가 잘못 본 줄 알았는데, 진짜더라구요. 실제로 확인을 해보기 위해, React Native 레벨에서 <code>node_modules</code>에 다운받아져있는 라이브러리를 직접 수정 후 결과를 확인해봤습니다.</p><p><img loading="lazy" alt="10" src="/getcha_frontend_docs/assets/images/10-cadbe6879111f56db15721b1a229c695.png" width="1516" height="858" class="img_E7b_"></p><p>결과는 아주 잘 나왔습니다. 즉시 정상적으로 동작했습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="오픈소스에-기여">오픈소스에 기여<a class="hash-link" href="#오픈소스에-기여" title="Direct link to heading">​</a></h3><p>이 문제때문에 고통받는 개발자가 몇분 있었고, 다행히 제가 해결했으니 <a href="https://github.com/react-native-webview/react-native-webview/pull/2548" target="_blank" rel="noopener noreferrer">Pull Request</a>를 날려서 오픈소스에 기여해보기로 했습니다. 일단 <a href="https://github.com/react-native-webview/react-native-webview" target="_blank" rel="noopener noreferrer">공식 repository</a>를 fork받고, 수정사항을 확인한 뒤 포맷에 맞춰 commit을 날리고, upstream branch로 pull requset를 올렸습니다.</p><p><img loading="lazy" alt="11" src="/getcha_frontend_docs/assets/images/11-54704442e639ea3d2ce71dc6d105f671.png" width="1830" height="586" class="img_E7b_"></p><p>너무 제가 필요한 부분만 고치게 될까봐, IOS Developers의 <a href="https://developer.apple.com/documentation/webkit/wkdownload/3727342-webview/" target="_blank" rel="noopener noreferrer">WKWebview Class 공식 문서</a>를 확인하고 추가로 수정해야할 사항이 있는지 확인한 뒤, 추가 수정사항을 반영해 PR을 올렸습니다.</p><p><img loading="lazy" alt="12" src="/getcha_frontend_docs/assets/images/12-dc8b5aab67605630b103c0acf54c89e6.png" width="1698" height="1280" class="img_E7b_"></p><p>아래 코멘트는 이 라이브러리의 메인테이너인데요, 리팩토링하다가 누락했다고 합니다 😇 (내 귀한 시간 ..ㅎ)</p><p><img loading="lazy" alt="13" src="/getcha_frontend_docs/assets/images/13-27db4c29e9996ae0745258737bd1fb0e.png" width="1656" height="338" class="img_E7b_"></p><p>여하튼 여차저차 해서 제 PR이 반영되었습니다.</p><p><img loading="lazy" alt="14" src="/getcha_frontend_docs/assets/images/14-5b9ae1ed7ea3b18fc021a1fc4e9d6bdf.png" width="1672" height="262" class="img_E7b_"></p><p>이와 동시에, 아래 사진을 보면 제 코멘트 우측에 <code>Contributor</code> 태그가 생긴 것을 볼 수 있습니다. Contribute는 기여하다라는 뜻인데요. 단어선택을 정말 잘 한 것 같다는 생각이 들었어요 👍 아주 작은 수정이지만, 이 라이브러리에게는 작은 버그가 사라진 셈이니까요.</p><p>사실 그것보다도 이 이슈로 고통받던 사람들을 해방시켜줬다는 사실이 더 뿌듯합니다.</p><p><img loading="lazy" alt="15" src="/getcha_frontend_docs/assets/images/15-14a95d0d1ad379ff216e5000b9588bee.png" width="1670" height="918" class="img_E7b_"></p><p>이번 대응에는 디버깅에 거의 하루라는 시간을 소모했지만, 이렇게 문제도 해결하고 오픈소스에도 기여할 수 있는 좋은 기회였습니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="다음에도-라이브러리에-문제가-있다면">다음에도 라이브러리에 문제가 있다면?<a class="hash-link" href="#다음에도-라이브러리에-문제가-있다면" title="Direct link to heading">​</a></h2><p>결론부터 말하면 당장은 방법이 없습니다.</p><p>웹이었다면 stable 버전으로 바꿔서 배포하거나, fork하고 조금 수정해서 배포하면 됩니다. 하지만 앱이라면 문제가 다릅니다. hotfix가 불가능하기 때문이에요. 배포하기까지 심사를 거쳐야하고, 영업일 기준 1~2일이 소요됩니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="code-push">Code Push<a class="hash-link" href="#code-push" title="Direct link to heading">​</a></h3><p>React Native나 Flutter같은 하이브리드 앱의 장점 중 하나는 네이티브 앱에서는 불가능한 hotfix가 가능하다는 점입니다. 하지만 코드푸시도 네이티브 코드를 고치거나 패키지 버전 변경같이 설치할 때 진행되는 프로세스에 포함되는 코드는 수정할 수 없습니다. 즉, 코드푸시로도 라이브러리 오류 문제를 해결할 수 없습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="fs-모듈">fs 모듈<a class="hash-link" href="#fs-모듈" title="Direct link to heading">​</a></h3><p>노드 실행환경에는 기본 api들이 제공되는데, 그 중 fs라는 모듈이 있습니다. file system에 접근하게 해주는 모듈인데, 이 모듈로 런타임에 node_modules을 수정할 수 있지 않을까 생각해봤는데요, 생각해보니 앱을 설치하는 순간 앱은 node_modules를 각각 플랫폼에 맞는 형태로 변환합니다.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>플랫폼별 node_module 변환</h5></div><div class="admonition-content"><p>IOS → Pods</p><p>Android → AndroidX</p></div></div><p>그래서 런타임에는 node modules에 접근할 수 없습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="react-native-fs">react-native-fs<a class="hash-link" href="#react-native-fs" title="Direct link to heading">​</a></h3><p><a href="https://github.com/itinance/react-native-fs" target="_blank" rel="noopener noreferrer">react-native-fs</a>는 네이티브 코드 레벨에서 file system에 접근할 수 있게 해주는 라이브러리입니다. 안타깝게도 라이브러리와 직접 연관되어있는 <strong>Pods</strong>에는 접근이 되지 않는 것 같았고, Download 폴더, Library 폴더, Document 폴더 등에는 접근 가능한 것으로 확인했습니다. 이마저도 런타임에 파일을 고치기보다는 파일 업로드나 Native 레벨의 정적 asset에 접근하는 용도로 활용합니다.</p><p><img loading="lazy" alt="16" src="/getcha_frontend_docs/assets/images/16-8e00093315520b7eb68f0637d036e63a.png" width="390" height="330" class="img_E7b_"></p><p>이번에 방법을 찾았더라면 <strong>React Native</strong> + <strong>Code Push</strong>의 효과를 극대화할 수 있을 것이라 생각했는데 그렇지 못해 조금 아쉽긴 합니다. 두 플랫폼 다 node_modules라는 개념이 프리빌드 페이즈에서 사라진다는 점 때문에 런타임에 뭔가를 수정한다면 <code>react-native-fs</code> 뿐이긴 합니다면, 네이티브 코드가 수정되어 빌드되고 반영되는지를 확인을 해보지 못해서 아직 명확하지 않고 되더라도 네이티브 개발을 할 줄 알아야하니 그리 효율적인 방법 같지는 않습니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="의존성과-종속성에-대하여">의존성과 종속성에 대하여<a class="hash-link" href="#의존성과-종속성에-대하여" title="Direct link to heading">​</a></h2><p>이번 사태로 배운점이 있다면 <strong>의존성</strong>과 <strong>종속성</strong>을 조절하지 못하면 언젠가 문제가 생기고, 우리는 이에 대한 해결책을 가지고 있어야한다는 점입니다. 실제로 이번 라이브쇼 프로젝트는 자사 서비스가 아닌 제휴사와의 계약사항이었고 릴리즈 날짜가 픽스되어있는 작업이었는데, 사용하는 서드파티 라이브러리로 인해 정상 서비스를 할 수 없는 사태가 발생했을 때, 그 책임을 이 오픈소스가 짊어지지 않습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="큰-라이브러리도-틀릴-수-있다">큰 라이브러리도 틀릴 수 있다<a class="hash-link" href="#큰-라이브러리도-틀릴-수-있다" title="Direct link to heading">​</a></h3><p>이번에 문제가 되었던 라이브러리는 <a href="https://github.com/react-native-webview/react-native-webview" target="_blank" rel="noopener noreferrer">react-native-webview</a>입니다. 월 다운로드수가 150만이고, star는 4700개네요. 굉장히 크고 활발히 유지되는 라이브러리라 볼 수 있습니다.</p><p><img loading="lazy" alt="17" src="/getcha_frontend_docs/assets/images/17-f6917c2d78cca1028ff36f878e9764b7.png" width="2364" height="424" class="img_E7b_"></p><p>이 정도의 커다란 라이브러리에서도 장애가 발생합니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="뭐든-도입할-땐-신중하자">뭐든, 도입할 땐 신중하자<a class="hash-link" href="#뭐든-도입할-땐-신중하자" title="Direct link to heading">​</a></h3><p>우리는 개발공수를 줄이기 위해 라이브러리를 가져다 사용하곤 합니다. 라이브러리는 복잡한 기능을 간단히 <strong>모듈화</strong>해주고, <strong>관리해야할 코드를 줄여주는</strong> 장점을 가지고 있습니다.</p><p>하지만 어떤 문제를 야기할지 모릅니다. 그리고 문제가 발생했을 때 <strong>손을 쓸 수 있는 방법이 많이 없고</strong>, 그 문제를 발견하는데 오랜 시간이 걸릴 수 있습니다.</p><p>그러므로 새로운 라이브러리를 도입할 땐 팀원들 간의 합의가 필요하고, <strong>꼭 필요한지</strong> 검증하는 단계가 있어야하며 그렇지 않다면 최대한 <strong>안정적인 라이브러리들을 활용해서 구현</strong>해야한다고 생각합니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="핵심-기능은-우리-손에-있어야-한다">핵심 기능은 우리 손에 있어야 한다.<a class="hash-link" href="#핵심-기능은-우리-손에-있어야-한다" title="Direct link to heading">​</a></h3><p>각 서비스에서 코어 패키지가 있을겁니다. 가령 비디오 영상 플렛폼에서는 비디오 플레이어 라이브러리가 될 것이고, 쇼핑몰 앱에서는 그리드 뷰가 될 수 있겠습니다. getcha의 코어 패키지는 웹뷰와 탭뷰입니다.</p><p>이번 <code>react-native-webview</code>이슈와 비슷하게, <code>react-native-tab-view</code>도 오작동 이슈가 있었습니다. 메이져 업데이트를 하고나니 컨텐츠가 보이지 않는 치명적인 버그였습니다. 당장은 동작하도록 수습은 해두었지만, 이 부분은 아직도 레거시로 남아있습니다.</p><p>핵심 기능을 우리가 직접 구현하지 않으면, 이런 문제는 반복될 수밖에 없습니다. 저는 라이브러리를 가져다 사용하는 것 자체가 <strong>기술부채</strong>라고 생각합니다. 기술부채에서 <strong>부채</strong>라는 단어는 빚을 낸다는 뜻인데, 문제 해결을 위해 기술적으로 미래에 갚아야 할 빚을 만드는 것입니다. 나보다 훨씬 뛰어난 개발자가 나보다 더 잘 만든 패키지를 제공해준다는데 뭐가 문제냐 할 수도 있겠지만, 언제까지 그 개발자가 패키지를 유지해줄지는 보장할 수 없습니다.</p><p>물론 모든 기능을 최소한의 패키지만 사용해서 개발하는 것은 불가능에 가깝습니다. 하지만 그 선은 내부 합의로 정해야 하고, 같은 기능이라도 어떤 라이브러리를 사용할지에도 신중해야합니다.</p></div><footer class="row docusaurus-mt-lg blogPostDetailsFull_h6_j"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/getcha_frontend_docs/blog/tags/react-native">react-native</a></li></ul></div><div class="col margin-top--sm"><a href="https://github.com/hojunin/getcha_frontend_docs/blog/2022-06-25-library/index.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_dcUD" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Blog post page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/getcha_frontend_docs/blog/react"><div class="pagination-nav__sublabel">Newer Post</div><div class="pagination-nav__label">리액트 쿼리, 효과적으로 활용해보자.</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/getcha_frontend_docs/blog/modal"><div class="pagination-nav__sublabel">Older Post</div><div class="pagination-nav__label">겟차에서 모달을 컨트롤하는 방법</div></a></div></nav></main><div class="col col--2"><div class="tableOfContents_cNA8 thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#뭐가-문제였을까" class="table-of-contents__link toc-highlight">뭐가 문제였을까</a><ul><li><a href="#라이브쇼-솔루션" class="table-of-contents__link toc-highlight">라이브쇼 솔루션</a></li><li><a href="#웹" class="table-of-contents__link toc-highlight">웹</a></li><li><a href="#앱react-native" class="table-of-contents__link toc-highlight">앱(React Native)</a></li><li><a href="#앱네이티브---ios" class="table-of-contents__link toc-highlight">앱(네이티브 - IOS)</a></li></ul></li><li><a href="#알고보니-라이브러리가-문제였다" class="table-of-contents__link toc-highlight">알고보니 라이브러리가 문제였다.</a><ul><li><a href="#그럼-직접-까보자" class="table-of-contents__link toc-highlight">그럼 직접 까보자</a></li><li><a href="#코드-부검-시작" class="table-of-contents__link toc-highlight">코드 부검 시작!</a></li><li><a href="#오픈소스에-기여" class="table-of-contents__link toc-highlight">오픈소스에 기여</a></li></ul></li><li><a href="#다음에도-라이브러리에-문제가-있다면" class="table-of-contents__link toc-highlight">다음에도 라이브러리에 문제가 있다면?</a><ul><li><a href="#code-push" class="table-of-contents__link toc-highlight">Code Push</a></li><li><a href="#fs-모듈" class="table-of-contents__link toc-highlight">fs 모듈</a></li><li><a href="#react-native-fs" class="table-of-contents__link toc-highlight">react-native-fs</a></li></ul></li><li><a href="#의존성과-종속성에-대하여" class="table-of-contents__link toc-highlight">의존성과 종속성에 대하여</a><ul><li><a href="#큰-라이브러리도-틀릴-수-있다" class="table-of-contents__link toc-highlight">큰 라이브러리도 틀릴 수 있다</a></li><li><a href="#뭐든-도입할-땐-신중하자" class="table-of-contents__link toc-highlight">뭐든, 도입할 땐 신중하자</a></li><li><a href="#핵심-기능은-우리-손에-있어야-한다" class="table-of-contents__link toc-highlight">핵심 기능은 우리 손에 있어야 한다.</a></li></ul></li></ul></div></div></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">겟차 서비스</div><ul class="footer__items"><li class="footer__item"><a href="https://m.getcha.kr/" target="_blank" rel="noopener noreferrer" class="footer__link-item">겟차<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://hojunin.github.io/react-query-kr/" target="_blank" rel="noopener noreferrer" class="footer__link-item">리액트 쿼리 번역 프로젝트<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">동료를 찾아요!</div><ul class="footer__items"><li class="footer__item"><a href="https://www.wanted.co.kr/wd/100800" target="_blank" rel="noopener noreferrer" class="footer__link-item">지원하러 가기<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Getcha Frontend Chapter</div></div></div></footer></div>
<script src="/getcha_frontend_docs/assets/js/runtime~main.625e365d.js"></script>
<script src="/getcha_frontend_docs/assets/js/main.79479b78.js"></script>
</body>
</html>