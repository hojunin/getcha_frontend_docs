<!doctype html>
<html lang="en" dir="ltr" class="blog-wrapper blog-list-page plugin-blog plugin-id-default">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.18">
<link rel="alternate" type="application/rss+xml" href="/getcha_frontend_docs/blog/rss.xml" title="🚘 겟차 프론트엔드 챕터입니다 RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/getcha_frontend_docs/blog/atom.xml" title="🚘 겟차 프론트엔드 챕터입니다 Atom Feed">
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=G-GED69DZF72"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-GED69DZF72",{})</script><title data-rh="true">Blog | 🚘 겟차 프론트엔드 챕터입니다</title><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="og:url" content="https://hojunin.github.io/getcha_frontend_docs/blog"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="Keywords" content="겟차, 프론트엔드, 겟차 프론트엔드"><meta data-rh="true" property="og:title" content="Blog | 🚘 겟차 프론트엔드 챕터입니다"><meta data-rh="true" name="description" content="Blog"><meta data-rh="true" property="og:description" content="Blog"><meta data-rh="true" name="docusaurus_tag" content="blog_posts_list"><meta data-rh="true" name="docsearch:docusaurus_tag" content="blog_posts_list"><link data-rh="true" rel="icon" href="/getcha_frontend_docs/img/getcha_favicon.ico"><link data-rh="true" rel="canonical" href="https://hojunin.github.io/getcha_frontend_docs/blog"><link data-rh="true" rel="alternate" href="https://hojunin.github.io/getcha_frontend_docs/blog" hreflang="en"><link data-rh="true" rel="alternate" href="https://hojunin.github.io/getcha_frontend_docs/blog" hreflang="x-default"><link rel="stylesheet" href="/getcha_frontend_docs/assets/css/styles.da05210c.css">
<link rel="preload" href="/getcha_frontend_docs/assets/js/runtime~main.ded042b8.js" as="script">
<link rel="preload" href="/getcha_frontend_docs/assets/js/main.f94d607f.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_ZgBM">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/getcha_frontend_docs/"><div class="navbar__logo"><img src="/getcha_frontend_docs/img/getcha_logo.svg" alt="Getcha_Logo" class="themedImage_W2Cr themedImage--light_TfLj"><img src="/getcha_frontend_docs/img/getcha_logo.svg" alt="Getcha_Logo" class="themedImage_W2Cr themedImage--dark_oUvU"></div><b class="navbar__title">겟차 프론트엔드 챕터</b></a><a class="navbar__item navbar__link" href="/getcha_frontend_docs/docs/intro">앱</a><a class="navbar__item navbar__link" href="/getcha_frontend_docs/utils-docs/intro">유틸</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/getcha_frontend_docs/blog">블로그</a></div><div class="navbar__items navbar__items--right"><a href="https://www.npmjs.com/package/getcha-react-ui-components" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">겟차 UI Components<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_S7eR colorModeToggle_vKtC"><button class="clean-btn toggleButton_rCf9 toggleButtonDisabled_Pu9x" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_v35p"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_nQuB"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper"><div class="container margin-vert--lg"><div class="row"><aside class="col col--3"><nav class="sidebar_a9qW thin-scrollbar" aria-label="Blog recent posts navigation"><div class="sidebarItemTitle_uKok margin-bottom--md">Recent posts</div><ul class="sidebarItemList_Kvuv"><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/react">리액트 쿼리, 효과적으로 활용해보자.</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/library">라이브러리에 문제가 생겼어요.</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/modal">겟차에서 모달을 컨트롤하는 방법</a></li><li class="sidebarItem_CF0Q"><a class="sidebarItemLink_miNk" href="/getcha_frontend_docs/blog/team-blog">도큐사우루스를 활용한 겟차 프론트엔드 팀 사이트 만들기</a></li></ul></nav></aside><main class="col col--7" itemscope="" itemtype="http://schema.org/Blog"><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/getcha_frontend_docs/blog/react">리액트 쿼리, 효과적으로 활용해보자.</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-07-05T00:00:00.000Z" itemprop="datePublished">July 5, 2022</time> · <!-- -->16 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18079523?v=4" alt="Nick"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nick</span></a></div><small class="avatar__subtitle" itemprop="description">FrontEnd Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>안녕하세요. Getcha 프론트엔드 개발자 <strong>Nick</strong>입니다 😜</p><p>지난주 내내 Getcha 8.2.0 마이너 업데이트를 앞두고 좋은 유저경험을 위한 라이브러리를 다양하게 설치 및 테스트가 한창이었습니다. 하지만 기쁜 마음도 잠시, 분명 UI 라이브러리를 설치중이었는데 redux-saga가 동작을 멈춰버리는 기이한 현상을 맞이했습니다. 라이브러리 마이너 패치도 3년전이고, 이슈는 이유를 알 수도 없었습니다(연관성이 1도 없었습니다 ㅠ)</p><p>결국 Saga에 더이상 의존할 수 없다고 <em>CTO님, 챕터원들과 논의 후</em> 판단하여 React-Query 전면 도입을 결정하고 Saga를 빠르게 걷어내기로 했습니다.</p><p><img loading="lazy" alt="으아악" src="/getcha_frontend_docs/assets/images/0-efdd160256b1b8005dd31e46acb8112c.png" width="2112" height="360" class="img_E7b_"></p><p>Saga 걷어내기 작업에 앞서, <strong>react query</strong>를 효율적으로 활용할 수 있는 방법이 필요합니다. 현재 작성되어있는 useQuery Wrapper 함수가 있긴 한데, 몇몇 부분에서 비효율적이고 type safe하지 않다고 생각했기 때문에 전면 수정을 결정한 이상 최적의 모델을 찾고, 이를 활용한 boilerplate를 만들어 공유하는 작업이 선행되어야 했습니다.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>이번에 만들 부분은 다음과 같은 형태가 되어야합니다.</h5></div><div class="admonition-content"><ul><li><strong>type-safe</strong> 해야한다.</li><li>계발 레벨에서 생산성이 높아야한다.</li><li>호출 레벨에서 신경쓰지 않아도 되는 부분은 걷어내야한다.</li></ul></div></div><p>이렇게 정의된 <code>useQueryApi</code>를 참고해서, <code>useQueries</code>, <code>useInfiniteQuery</code>, <code>useMutation</code>를 정의하는 것이 목표입니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="현재-상황">현재 상황<a class="hash-link" href="#현재-상황" title="Direct link to heading">​</a></h2><p>현재 useQuery를 감싸서 만든 함수가 정의되어있고, 내부에서는 Axios를 활용한 Api Client 인스턴스를 React Query로 호출하는 형태입니다. 이 훅이 하는 일은 key와 parameter를 받아 여러 처리를 하고 API 인스턴스를 선언하여 호출하고 그 결과를 반환합니다.</p><div class="codeBlockContainer_I0IT language-tsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-tsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> useBaseQueryApi </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Res</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Req</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    key</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">TQueryKey</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Req</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">|</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    config</span><span class="token operator" style="color:#393A34">?</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token maybe-class-name">IConfig</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">TQueryConfig</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Res</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token maybe-class-name">Req</span><span class="token operator" style="color:#393A34">&gt;&gt;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// [url, parameters] 형태로 넘어왔는지 여부</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> isKeyArray </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token known-class-name class-name">Array</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">isArray</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">&amp;&amp;</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// error 처리</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> error </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useRef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> isError </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useRef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token boolean" style="color:#36acaa">false</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// baseFetch : Axios 인스턴스</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> apiFetcher </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">baseFetch</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">ex</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token builtin">any</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">current </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ex</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isError</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">current </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// url, params</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> url </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isKeyArray </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token builtin">string</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> params </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isKeyArray </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> key</span><span class="token punctuation" style="color:#393A34">[</span><span class="token number" style="color:#36acaa">1</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token keyword nil" style="color:#00009f">undefined</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">Req</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token comment" style="color:#999988;font-style:italic">// react-query 실행</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> result </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        key</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">async</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token generic-function function" style="color:#d73a49">apiFetcher</span><span class="token generic-function generic class-name operator" style="color:#393A34">&lt;</span><span class="token generic-function generic class-name maybe-class-name">Res</span><span class="token generic-function generic class-name punctuation" style="color:#393A34">,</span><span class="token generic-function generic class-name"> </span><span class="token generic-function generic class-name maybe-class-name">Req</span><span class="token generic-function generic class-name operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">url</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">axiosConfig</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        config</span><span class="token operator" style="color:#393A34">?.</span><span class="token plain">queryConfig</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">as</span><span class="token plain"> </span><span class="token maybe-class-name">UseQueryResult</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token maybe-class-name">Res</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token known-class-name class-name">Error</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">result</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        error</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> error</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">current</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        isError</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> isError</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">current</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="변경해야-하는-이유">변경해야 하는 이유<a class="hash-link" href="#변경해야-하는-이유" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="얕은-결합성">얕은 결합성<a class="hash-link" href="#얕은-결합성" title="Direct link to heading">​</a></h3><p><code>useQuery</code>에서 <code>key</code>, <code>queryFunction</code> 은 <code>required</code> 입니다. 즉 두 parameter는 하나의 <code>useQuery</code> 훅을 구성하는 요소이고 이 호출단위로 cache가 관리됩니다. 이 말은 <code>key</code>와 <code>queryFunction</code>은 하나의 세트이기 때문에 명확히 묶어서 관리해야 한다는 뜻입니다. 하지만 현재 사용방식을 보면 데이터의 type 정의와 queryFunction, useQuery가 따로 관리되고 있습니다. 셋은 하나로 관리되어야 합니다.</p><p><img loading="lazy" alt="useQuery의 구조" src="/getcha_frontend_docs/assets/images/1-93d41cf7bb528ff4fa8c1cbc5bf0adbc.png" width="1202" height="518" class="img_E7b_"></p><blockquote><p>useQuery의 구조</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="key">Key<a class="hash-link" href="#key" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="키" src="/getcha_frontend_docs/assets/images/2-bfa7d3a8ecfa9b85268b8014029a6e79.png" width="1154" height="170" class="img_E7b_"></p><blockquote><p>cache의 일부분</p></blockquote><p>현재 <code>key</code>는 <code>queryFucntion</code>의 Endpoint로 관리되고 있는데, 이건 현재의 방식을 조금 수정해서 사용하면 될 것 같습니다. 다만, 저희가 baseUrl을 3개를 쓰고 있는데, 이 부분은 <code>queryClient</code>를 정의할 때가 아닌 <code>queryFunction</code> 레벨에서 정의되어야 할 것 같습니다.</p><p>또한 api version이 backend의 요구에 맞추어 7, 7.1, 7.2로 나눠져 있는데 이 부분까지 EndPoint에 녹아있으므로 같이 관리하면 좋을 듯 합니다.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>❓ 만약 현재의 구조를 그대로 유지한다고 한다면?</h5></div><div class="admonition-content"><p>동일한 쿼리가 <code>v7</code>, <code>v7.1</code>, <code>v7.2</code>에서 각각 다르게 동작한다면 구조가 바뀔겁니다. 버전 또한 받도록 변경되어야겠죠. <code>baseUrl</code> 또한 그렇습니다. <code>version</code>-<code>baseUrl</code>-<code>endPoint</code>로 쿼리함수가 정해지니까요. 이런 복잡성이 존재하는 한, 추상화 레벨을 <code>queryFunction</code> 단위로 정하고 관리하는 편이 좋겠습니다.</p></div></div><p>다만, key 자체는 우리가 const를 정의하듯, queryFunction 이름을 정하듯 한눈에 들어오는 이름을 사용하는게 좋아보입니다. 가령 위에서 <code>communityNotice, {forumId: 1}</code>이 <code>v7/car/compare/car-call</code>보다는 낫습니다. 왜냐하면 endpoint는 endpoint일 뿐 key가 아니고, 그냥 endpoint를 key로 활용하는 것 뿐이니까요.</p><p>또한 parameter는 key와 분리해서 array로 관리되어야 합니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="type">type<a class="hash-link" href="#type" title="Direct link to heading">​</a></h3><p>현재는 데이터가 리턴하는 데이터의 타입을 사용부에서 제네릭으로 적용합니다. 그렇기 때문에 type-safe하지 않습니다. 이 부분은 더 낮은 레벨인 <code>queryFunction</code> 레벨에서 정의되어야 합니다. queryFunction이 리턴하는 데이터는 서버로부터 정의되기 때문에 서버만 정확히 작동하면 <strong>명확</strong>하고, type-safe하기 때문입니다.</p><p><img loading="lazy" alt="스크린샷 2022-07-03 오후 11.38.12.png" src="/getcha_frontend_docs/assets/images/3-24789bfd3d6dbe95cdacfcde5b592943.png" width="932" height="216" class="img_E7b_"></p><p>위 사진은 현재 활용중인 useQueryApi입니다. Response Type이 <code>IResCarCompareAll</code>이라는 타입의 데이터로 assersion 되고 있습니다. useQueryApi 코드를 확인해보면 <code>queryFunction</code>의 입출력 타입과 관계없이 해당 useQuery의 Response Type으로 대입해버립니다.</p><p>하지만 useQuery의 Response Type은 queryFunction의 Response Type에 종속되므로, useQuery의 Response Type은 queryFunction의 Response를 받아서 사용해야합니다.</p><p><img loading="lazy" alt="스크린샷 2022-07-03 오후 11.54.34.png" src="/getcha_frontend_docs/assets/images/4-5a2da591ddafe2e6ef610e54d2742e66.png" width="1702" height="586" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="api-client가-혼재함">Api Client가 혼재함<a class="hash-link" href="#api-client가-혼재함" title="Direct link to heading">​</a></h3><p>저희 서비스는 Axios 인스턴스를 3개나 사용하는 특수한 상황에 놓여있습니다. 그래서 <code>useQuery</code> 훅 내에서 axios 설정 및 관리를 할 필요가 없다고 생각합니다. 또한 useQuery는 axios랑 관련이 없기 때문에 더더욱 의존성을 덜어내야 할 부분입니다.</p><div class="admonition admonition-caution alert alert--warning"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><path fill-rule="evenodd" d="M8.893 1.5c-.183-.31-.52-.5-.887-.5s-.703.19-.886.5L.138 13.499a.98.98 0 0 0 0 1.001c.193.31.53.501.886.501h13.964c.367 0 .704-.19.877-.5a1.03 1.03 0 0 0 .01-1.002L8.893 1.5zm.133 11.497H6.987v-2.003h2.039v2.003zm0-3.004H6.987V5.987h2.039v4.006z"></path></svg></span>caution</h5></div><div class="admonition-content"><p>axios는 queryFunction과 관련있습니다.</p></div></div><p>즉, 현재 상태에서 <code>useQuery</code>는 Api Client의 옵션을 받을 필요가 없습니다. 이 부분은 <code>queryFunction</code>의 영역이기 때문에 <code>queryFunction</code> 정의 부분에서 명확히 정의되어야 합니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="어떻게-변경할까">어떻게 변경할까?<a class="hash-link" href="#어떻게-변경할까" title="Direct link to heading">​</a></h2><p>결론적으로 제가 제안드리는 방식은,<code>key-queryFunction</code>을 hash-map으로 관리하고 <code>useQueryApi</code>를 재정의하여 key와 parameter만 주입하면 특정 타입 데이터를 받도록 하는 방식입니다.</p><p><img loading="lazy" alt="제안하는 방식" src="/getcha_frontend_docs/assets/images/5-ddbed3d1b7fe84b65a41ea2d91b10216.png" width="1608" height="756" class="img_E7b_"></p><p>제안하는 방식</p><ol><li>key와 parameter를 useQuery에 넘긴다.</li><li>useQueryApi는 keyMap에서 queryFunction을 조회해서 함수를 가져온다.</li><li>queryFunction에 parameter를 넘겨 useQuery 호출하면 type이 보장된 데이터를 받을 수 있다.</li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="usequeryapi">useQueryApi<a class="hash-link" href="#usequeryapi" title="Direct link to heading">​</a></h3><div class="codeBlockContainer_I0IT language-tsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-tsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword module" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> queryMap </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword module" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;queryMap&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">useQueryApi</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> config</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> queryKey </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token operator" style="color:#393A34">...</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> params</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">toString</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token operator" style="color:#393A34">!</span><span class="token plain">queryMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">has</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword control-flow" style="color:#00009f">throw</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Error</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;쿼리함수가 정의 되어있지 않습니다&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useQuery</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token operator" style="color:#393A34">...</span><span class="token plain">config</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        queryKey</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        queryFn</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> queryMap</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">get</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">keys</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="custom-hook">Custom Hook<a class="hash-link" href="#custom-hook" title="Direct link to heading">​</a></h3><p><code>useQueryApi</code>를 수정해서 현재 사용하고 있는 Redux-Saga를 React Custom Hook으로 구현하는 방법입니다.</p><p>일단 훅은 <strong>Type 단위</strong>로 생성합니다. 특정 타입 데이터를 CRUD하는 과정이 이 파일 하나에서 모두 이루어집니다.</p><p>또한 데이터를 가져와서 정제된 데이터를 주기 전까지 과정이 모두 이루어집니다. 이 과정이 모두 Saga에서 이루어졌는데, Custom Hook으로 대체할 수 있습니다. 가령 다음과 같은 형태가 될겁니다.</p><div class="codeBlockContainer_I0IT language-tsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-tsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// Car 데이터를 가져오는 쿼리.</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token function-variable function" style="color:#d73a49">useFetchCar</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> data</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> cars</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> isError </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">useQueryApi</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&#x27;carList&#x27;</span><span class="token punctuation" style="color:#393A34">]</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> page</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> enabled</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">false</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">if</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">isError </span><span class="token operator" style="color:#393A34">||</span><span class="token plain"> cars</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">length </span><span class="token operator" style="color:#393A34">===</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">0</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        toast</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token string" style="color:#e3116c">&#x27;차량 데이터에 문제가 발생했어요.&#x27;</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword control-flow" style="color:#00009f">return</span><span class="token plain"> cars</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">filter</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">car</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">!</span><span class="token plain">car</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">disable</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="key-queryfunction-매핑">key-queryFunction 매핑<a class="hash-link" href="#key-queryfunction-매핑" title="Direct link to heading">​</a></h3><p>JavaScript의 자료구조인 <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Map" target="_blank" rel="noopener noreferrer">Map</a>을 사용할것입니다.</p><p>Map은 Object와 비슷하지만 다양한 차이점이 있습니다.</p><p>그 중, key의 type을 정할 수 있다는 점이 있습니다. string만 들어올 수 있는 Object와 달리 Map은 key의 타입을 정할 수 있습니다.</p><div class="codeBlockContainer_I0IT language-tsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-tsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token maybe-class-name">QueryKeies</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">[</span><span class="token string" style="color:#e3116c">&quot;carList&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;post&quot;</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">...</span><span class="token punctuation" style="color:#393A34">]</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> queryMap </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">new</span><span class="token plain"> </span><span class="token class-name known-class-name class-name">Map</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>함수 하나 당 키를 추상화하는 방법입니다. 아래 예시를 보면 페칭 쿼리가 뭔지는 모르겠지만 <code>todos라는 쿼리를 list로 가져오며 all 필터를 적용한다</code>. <code>상세 데이터를 가져오되 2번 id 데이터를 가져온다</code> 등의 명확하면서 강력한 추상화가 적용된 모습을 볼 수 있습니다.</p><p><img loading="lazy" alt="스크린샷 2022-07-03 오후 4.30.16.png" src="/getcha_frontend_docs/assets/images/6-ed9bedf6e92fc2d29fef77234b4bd10a.png" width="1576" height="298" class="img_E7b_"></p><p>key-callback 조합은 현재의 Constant 관리방법처럼 매우 길어질 가능성이 있습니다. 이를 key tree로 만들 수 있을겁니다. 아래는 함수 하나 당 query key를 여러개 만드는 예시입니다.</p><p><img loading="lazy" alt="출처: react-query 메인테이너 블로그" src="/getcha_frontend_docs/assets/images/7-ccda26f8e7c91128bcd6d821e4b6d667.png" width="1576" height="446" class="img_E7b_"></p><blockquote><p>출처: react-query 메인테이너 블로그</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="error-처리">error 처리<a class="hash-link" href="#error-처리" title="Direct link to heading">​</a></h3><p>에러가 발생하면 어떻게 처리할까</p><p>error 센터를 만들자. 여기서는 react query가 던지는 표준에러와 그 에러를 어떻게 처리할지에 대한 콜백함수를 같이 받습니다.</p><p>처리 콜백함수가 들어오면 그 콜백함수 로직을 먼저 타도록 합니다.</p><p>처리 콜백함수가 들어오지 않거나 처리 콜백함수를 전부 통과했는데도 에러가 처리되지 않으면, 기본 에러 처리 기준에 따라 처리합니다. 예를 들어 404면 페이지가 없습니다로 리다이렉팅, 500이면 서버가 죽었어요. 503이면 와이파이 확인하세요 ….</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="nullcheck--typeguard">nullCheck &amp; typeGuard<a class="hash-link" href="#nullcheck--typeguard" title="Direct link to heading">​</a></h3><p>useQuery의 데이터를 사용부에 전달하기 전에 최종확인 과정으로 null check와 typeGuard를 거쳐야합니다. 서버의 데이터가 항상 옳은 타입을 뱉을거라는 보장은 없습니다. 실수로 특정 key의 이름을 변경하거나 삭제할수도 있고 엉뚱한 데이터나 타입의 값이 내려올 수도 있습니다. 이런 경우를 마지막 전달하기 전에 검수합니다.</p><p><img loading="lazy" alt="스크린샷 2022-07-03 오후 5.12.39.png" src="/getcha_frontend_docs/assets/images/8-8bcb70c0f632410e21228c3b56f47d79.png" width="1858" height="248" class="img_E7b_"></p><ol><li><p>null check</p><p>null checking 과정에서는 data가 undefined인지 체크합니다. array여야하는 데이터가 비어있더라도 array인지 까지 확인합니다.</p></li><li><p>type guard</p><p>null check 과정을 거치고 나면 이 데이터가 실제 해당하는 타입인지를 알아야 합니다. id나 title 같은 필수 데이터 타입이 존재하는지, 일정 크기 이상인지 등을 확인해서 type-safe한지 마지막으로 확인합니다.</p></li></ol><p>위 두개 과정을 통과했다면 비로소 해당 데이터는 type-safe하므로 렌더링 부에 전달할 수 있습니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="이러면-뭐가-좋아지냐">이러면 뭐가 좋아지냐<a class="hash-link" href="#이러면-뭐가-좋아지냐" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="key-직관성">key 직관성<a class="hash-link" href="#key-직관성" title="Direct link to heading">​</a></h3><p>key가 endPoint에서 직관적인 이름으로 바뀝니다. 이 이름은 constant 폴더 내에서 관리될 것이며,</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="key--queryfn--type-safe-data">key + queryFn = type safe data<a class="hash-link" href="#key--queryfn--type-safe-data" title="Direct link to heading">​</a></h3><p>key와 queryFunction을 명확하게 연결해주고, queryFunction이 return하는 데이터가 명확하니 특정 key를 넣었을 때 react query가 리턴해주는 데이터는 typeScript의 관점에서 <strong>명확</strong>합니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="saga-대체">saga 대체<a class="hash-link" href="#saga-대체" title="Direct link to heading">​</a></h3><p>저희가 saga를 활용하던 방식을 custom hook으로 대체하면 거의 동일한 기능을 수행할 수 있습니다. redux 문법도 괴랄한데, 잘 쓰이지도 않는 generator 함수를 활용하는 saga의 패턴까지 전부 일반적으로 js에서 활용하는 문법들로 대체가 가능합니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="개발-생산성">개발 생산성<a class="hash-link" href="#개발-생산성" title="Direct link to heading">​</a></h3><p>useQueryApi에는 그저 key와 parameter만 넘기면 됩니다. key와 <a href="https://www.typescriptlang.org/docs/handbook/utility-types.html#parameterstype" target="_blank" rel="noopener noreferrer">parameter</a>는 자동완성으로 제공되므로 실수하지 않을 수 있습니다.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="마치며">마치며<a class="hash-link" href="#마치며" title="Direct link to heading">​</a></h2><p>명확하게 말할 수 있는 사실은, react query는 <strong>고레벨 라이브러리</strong>라는 점입니다. 데이터를 가져오는 과정을 쉽게 해줄 뿐이지 실제로 데이터를 가져오는 기능은 Axios나 fetch같은 <strong>HTTP Client Instance</strong>입니다. 즉, 데이터의 타입은 react-query 레벨에서 정해지지 않는다는 뜻입니다. 이 사실을 명확히 인지하고 type-safe한 값을 받을 수 있도록 명확한 과정을 거쳐야 합니다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/getcha_frontend_docs/blog/tags/react">react</a></li><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/getcha_frontend_docs/blog/tags/react-query">react-query</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/getcha_frontend_docs/blog/library">라이브러리에 문제가 생겼어요.</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-06-25T00:00:00.000Z" itemprop="datePublished">June 25, 2022</time> · <!-- -->21 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18079523?v=4" alt="Nick"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nick</span></a></div><small class="avatar__subtitle" itemprop="description">FrontEnd Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>안녕하세요. Getcha 프론트엔드 개발자 <strong>Nick</strong>입니다 😆</p><p>이번 겟차 &amp; 현대캐피탈 라이브쇼 준비 과정에서 발생했던 이슈를 해결했던 과정을 공유 드리려고해요. 이 과정에서 <em>서드파티 라이브러리</em>에 대한 관점이 바뀌었고, <em>비슷한 문제가 발생했을 때</em> 어떻게 대응해야하는지 생각해볼 필요가 있겠다는 생각에 이 회고의 글을 남깁니다.</p><p>사건의 발단은 웹에서 <code>iframe</code>을 활용해 임베딩한 <code>video</code> 태그가 Android에서는 잘 동작하는데, <strong>IOS에서 네이티브 플레이어로 풀스크린 재생이 되는 문제</strong>가 발견되면서 부터였습니다. 영상이 재생되긴 하니까 크리티컬하지 않다고 생각했는데, 생각해보니 비디오만 보일 뿐이지 라이브쇼 솔루션 개발사에서 제공하는 <strong>채팅</strong>이나 <strong>구매 플로우</strong>같은 핵심 UI를 IOS 네이티브 플레이어가 덮어버려서 꼭 해결해야겠다고 생각했습니다.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="뭐가-문제였을까">뭐가 문제였을까<a class="hash-link" href="#뭐가-문제였을까" title="Direct link to heading">​</a></h2><p>저희는 Native 앱이 아닌 <strong>React Native</strong>를 활용하고, 이 프로젝트는 <strong>WebView</strong>로 구현해둔 상태였습니다. 즉, 연결다리가 많다보니 어디가 문제인지 확실히 알 수 없어 디버깅에 하루를 통째로 갈아넣었던 것 같아요. 조금은 무식하지만 저는 문제가 될 수 있는 부분들을 전부 까보기로 했습니다. (본격 돌다리 두들기기)</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>문제의 구조</h5></div><div class="admonition-content"><p><img loading="lazy" alt="문제의 구조" src="/getcha_frontend_docs/assets/images/structure-3b20f993fae81ec0eb8fb7e7aefe797f.png" width="1694" height="744" class="img_E7b_"></p><p>당시의 상황은 위 사진과 같습니다.</p><p>그래서 다음의 모든 경우의 수에서 에러가 발생할 수 있으므로, 전부 확인해야 했습니다.</p><ul><li>네이티브 앱 레벨</li><li>React Native &amp; JavaScript 레벨</li><li>브릿지 역할을 하는 라이브러리</li><li>Webview용 웹페이지</li><li>라이브쇼 솔루션 회사 제품</li></ul></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="라이브쇼-솔루션">라이브쇼 솔루션<a class="hash-link" href="#라이브쇼-솔루션" title="Direct link to heading">​</a></h3><p>먼저 가장 빨리 확인할 수 있는 라이브쇼 솔루션을 체크했습니다. 간단한 property만 체크하면 되고, 문제 없으면 이제 <strong>저희 문제</strong>만 확인하면 되니까요. 여기서 제공하는 사이트를 임베딩해서 쓰는 방식이었으므로 간단히 element만 확인해봤습니다. 예상대로 <code>video</code> 태그와 <code>div</code> 태그들 뿐이었습니다.</p><p><img loading="lazy" alt="1" src="/getcha_frontend_docs/assets/images/1-837895786dd7ec4b40036ce11b521150.png" width="756" height="678" class="img_E7b_"></p><p><code>vidoe</code> tag의 property 중에 <code>playsinline</code>이라는 값이 있는데, 이 값이 중요합니다. true로 되어있는지를 확인해야 했거든요. 이 값이 true가 아니면, video 태그가 네이티브 플레이어로 재생됩니다. 보시는대로, 솔루션 업체는 명확하게 이 값을 true로 지정해 두었습니다. 즉, 솔루션쪽은 전혀 문제가 없다고 판단했습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="웹">웹<a class="hash-link" href="#웹" title="Direct link to heading">​</a></h3><p>다음은 웹에서 <code>iframe</code>으로 라이브쇼 솔루션을 임베딩하는 코드를 살펴봤습니다. 사실 이 부분은 볼 필요가 없었던게, <code>iframe</code>으로 솔루션 업체에서 제공하는 url을 임베딩하는 코드 말고는 없다고 봐도 무방했기 때문에, 몇몇 불필요한 property가 있는지만 확인했습니다.</p><p><img loading="lazy" alt="2" src="/getcha_frontend_docs/assets/images/2-34e4f2b801dc06ba54b6a5a3c8fde9a0.png" width="1646" height="1138" class="img_E7b_"></p><p>공식문서를 확인해보니, <code>allowFullscreen</code>같은 property가 있었는데, 이 문제를 해결하는데에는 효과가 없었습니다. 그래서 웹도 큰 문제가 없다고 판단했습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="앱react-native">앱(React Native)<a class="hash-link" href="#앱react-native" title="Direct link to heading">​</a></h3><p>앱에서는 <code>react-native-webview</code>라는 라이브러리를 통해 네이티브 웹뷰 클래스를 호출해 웹으로 만든 사이트를 띄우도록 되어 있어요. 문제가 있다면 라이브러리에 특정 기능을 활용하지 않아서라고 생각하고, <a href="https://github.com/react-native-webview/react-native-webview/blob/master/docs/Reference.md#allowsinlinemediaplayback" target="_blank" rel="noopener noreferrer">라이브러리 공식문서</a>를 살펴봤습니다.</p><p><img loading="lazy" alt="3" src="/getcha_frontend_docs/assets/images/3-6ee6ee4319e4271f17129759f328996b.png" width="1832" height="512" class="img_E7b_"></p><blockquote><p>찾았다 요놈!</p></blockquote><p>쭉쭉 내리다 보니 제가 찾고있던 property가 딱 있었습니다. property 이름에서 느낌이 와닿지 않아 찾는데 시간이 좀 걸렸습니다. ㅠ</p><p>그럼 이 값을 true로 주면 당연히 되겠지 했는데,</p><p><img loading="lazy" alt="wtf" src="/getcha_frontend_docs/assets/images/4-e922d1aa667d3b0364672ca8e850ad32.jpeg" width="613" height="533" class="img_E7b_"></p><p>무슨 이유인지 실행해보니 <strong>동작하지 않았습니다</strong>. 왜 이 때 라이브러리가 잘못되었다고 생각하지 않았는지 후 ..</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="앱네이티브---ios">앱(네이티브 - IOS)<a class="hash-link" href="#앱네이티브---ios" title="Direct link to heading">​</a></h3><p>일단 문제는 해결해야겠으니, 마지막으로 네이티브 레벨로 내려왔습니다.</p><p>다행히 이 이슈가 React Native 레벨 문제라고 하더라도, 실행 로직이 아니다보니 가장 낮은 레벨인 Native 레벨에서 configuration 정도는 강제로 변경할 수 있다고 생각했습니다.</p><p>React Native에서 Native Module을 활용하는 라이브러리는 IOS의 Pods에서 관리됩니다. objective-c로 작성되어 있는데, RN 레벨에서는 확장자가 .h인 <strong>header 파일</strong>만 존재하고, Native 레벨에서는 확장자가 .m인 <strong>구현체 파일</strong>까지 존재합니다.</p><p>.h 파일은 사용할 변수나 메소드를 정의하고, .m은 이를 바탕으로 변수 및 get, set 메소드를 자동생성해줍니다. 저는 이 중에서 제가 필요한 property인 <code>allowsInlinePlayback</code>이라는 변수를 set하는 메소드가 동작하지 않는다고 가정하고, assignment 부분을 initialize처럼 동작하도록 강제했습니다.</p><p>아래는 이와 관련된 깃 이슈에 올린 솔루션입니다.</p><p><img loading="lazy" alt="5" src="/getcha_frontend_docs/assets/images/5-d5beb7a83d75372af9e395c54b25f480.png" width="1672" height="1194" class="img_E7b_"></p><p>이렇게 수정한 결과, 문제없이 동작했습니다. 해결한 다음날이 라이브쇼 첫방송이다보니 퇴근 직전에 문제 해결하고 긴장이 쫙 풀렸던 기억이 납니다. 😵‍💫</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="알고보니-라이브러리가-문제였다">알고보니 라이브러리가 문제였다.<a class="hash-link" href="#알고보니-라이브러리가-문제였다" title="Direct link to heading">​</a></h2><p>당장 급한 불을 껐으니, 진짜 문제를 해결하기 위해 마지막으로 라이브러리를 확인해봤습니다.</p><p><code>react-native-webview</code>는 react-native에서 비공식이지만 권장하는 webview 기능이기 때문에 오류가 있을 것이라고는 상상도 못했습니다. <code>react-native-webview</code> 깃허브에 이슈를 확인해보니 <a href="https://github.com/react-native-webview/react-native-webview/issues/2544" target="_blank" rel="noopener noreferrer">비슷한 이슈</a>가 있어 comment를 남기고 소통을 시도했지만 별 소용이 없었어요.</p><p><img loading="lazy" alt="6" src="/getcha_frontend_docs/assets/images/6-4c7f24d489334a106a58f65008d50b55.png" width="1826" height="300" class="img_E7b_"></p><blockquote><p>공허하다..</p></blockquote><h3 class="anchor anchorWithStickyNavbar_mojV" id="그럼-직접-까보자">그럼 직접 까보자<a class="hash-link" href="#그럼-직접-까보자" title="Direct link to heading">​</a></h3><p>사실 거의 공식 라이브러리다보니 문제가 있을거라는 <strong>의심</strong>도 없었고, 해결할 것이라고는 <strong>기대</strong>도 하지 않았습니다. 그래서 마지막에 확인했던 것이었어요.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>react-native의 커뮤니티급 라이브러리</h5></div><div class="admonition-content"><p>이런 커뮤니티급 라이브러리는 보통 React Native로 Android나 IOS 네이티브 코드를 조작하는 라이브러리입니다. 가령 <code>react-native-webview</code>는 Android Webview클래스와 IOS의 WKWebview 클래스를 직접 조작해요. 아래 사진과 같이 동작합니다.</p><p><img loading="lazy" alt="7" src="/getcha_frontend_docs/assets/images/7-f048b7bad62c4439e40977d96dc641a8.png" width="1156" height="404" class="img_E7b_"></p><p>즉, 목적이 React Native 개발자가 WebView같은 네이티브 클래스를 네이티브 코드 조작 없이 다룰 수 있게하는 라이브러리입니다.</p><p><img loading="lazy" alt="18" src="/getcha_frontend_docs/assets/images/18-d03e656998d6f1434e1a5569bc3899ef.png" width="1716" height="302" class="img_E7b_"></p><p>위 사진과 같이 리액트 네이티브에서는 기본으로 제공하던 기능을 특정 기능을 모듈로 분리해 <strong>커뮤니티급 라이브러리</strong>로 관리합니다. React Native 공식 홈페이지를 보면 위와 같이 안내하므로, 비공식이지만 <strong>기본 제공 기능</strong>처럼 활용하곤 합니다.</p></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="코드-부검-시작">코드 부검 시작!<a class="hash-link" href="#코드-부검-시작" title="Direct link to heading">​</a></h3><p>먼저 React Native단에서 넘겨주는 property를 확인했습니다. 문서에 적힌대로 대부분 잘 받아오는 것을 볼 수 있었습니다.</p><p><img loading="lazy" alt="8" src="/getcha_frontend_docs/assets/images/8-73e9cef6c99981b2dd12d5bc94b35343.png" width="1118" height="1312" class="img_E7b_"></p><p>아래 사진은 위에서 받아온 props를 여차저차 가공을 하거나 그대로 받아서 실제 Native Module의 Webview 클래스 구현체를 만드는 과정입니다.</p><p><img loading="lazy" alt="9" src="/getcha_frontend_docs/assets/images/9-dc1655568d142fd62939f62660545bc2.png" width="1420" height="1218" class="img_E7b_"></p><p>잘 보면, 위에서 받아온 property 몇개가 아래로 전달이 안되고 있었습니다. 저는 당연히 제가 잘못 본 줄 알았는데, 진짜더라구요. 실제로 확인을 해보기 위해, React Native 레벨에서 <code>node_modules</code>에 다운받아져있는 라이브러리를 직접 수정 후 결과를 확인해봤습니다.</p><p><img loading="lazy" alt="10" src="/getcha_frontend_docs/assets/images/10-cadbe6879111f56db15721b1a229c695.png" width="1516" height="858" class="img_E7b_"></p><p>결과는 아주 잘 나왔습니다. 즉시 정상적으로 동작했습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="오픈소스에-기여">오픈소스에 기여<a class="hash-link" href="#오픈소스에-기여" title="Direct link to heading">​</a></h3><p>이 문제때문에 고통받는 개발자가 몇분 있었고, 다행히 제가 해결했으니 <a href="https://github.com/react-native-webview/react-native-webview/pull/2548" target="_blank" rel="noopener noreferrer">Pull Request</a>를 날려서 오픈소스에 기여해보기로 했습니다. 일단 <a href="https://github.com/react-native-webview/react-native-webview" target="_blank" rel="noopener noreferrer">공식 repository</a>를 fork받고, 수정사항을 확인한 뒤 포맷에 맞춰 commit을 날리고, upstream branch로 pull requset를 올렸습니다.</p><p><img loading="lazy" alt="11" src="/getcha_frontend_docs/assets/images/11-54704442e639ea3d2ce71dc6d105f671.png" width="1830" height="586" class="img_E7b_"></p><p>너무 제가 필요한 부분만 고치게 될까봐, IOS Developers의 <a href="https://developer.apple.com/documentation/webkit/wkdownload/3727342-webview/" target="_blank" rel="noopener noreferrer">WKWebview Class 공식 문서</a>를 확인하고 추가로 수정해야할 사항이 있는지 확인한 뒤, 추가 수정사항을 반영해 PR을 올렸습니다.</p><p><img loading="lazy" alt="12" src="/getcha_frontend_docs/assets/images/12-dc8b5aab67605630b103c0acf54c89e6.png" width="1698" height="1280" class="img_E7b_"></p><p>아래 코멘트는 이 라이브러리의 메인테이너인데요, 리팩토링하다가 누락했다고 합니다 😇 (내 귀한 시간 ..ㅎ)</p><p><img loading="lazy" alt="13" src="/getcha_frontend_docs/assets/images/13-27db4c29e9996ae0745258737bd1fb0e.png" width="1656" height="338" class="img_E7b_"></p><p>여하튼 여차저차 해서 제 PR이 반영되었습니다.</p><p><img loading="lazy" alt="14" src="/getcha_frontend_docs/assets/images/14-5b9ae1ed7ea3b18fc021a1fc4e9d6bdf.png" width="1672" height="262" class="img_E7b_"></p><p>이와 동시에, 아래 사진을 보면 제 코멘트 우측에 <code>Contributor</code> 태그가 생긴 것을 볼 수 있습니다. Contribute는 기여하다라는 뜻인데요. 단어선택을 정말 잘 한 것 같다는 생각이 들었어요 👍 아주 작은 수정이지만, 이 라이브러리에게는 작은 버그가 사라진 셈이니까요.</p><p>사실 그것보다도 이 이슈로 고통받던 사람들을 해방시켜줬다는 사실이 더 뿌듯합니다.</p><p><img loading="lazy" alt="15" src="/getcha_frontend_docs/assets/images/15-14a95d0d1ad379ff216e5000b9588bee.png" width="1670" height="918" class="img_E7b_"></p><p>이번 대응에는 디버깅에 거의 하루라는 시간을 소모했지만, 이렇게 문제도 해결하고 오픈소스에도 기여할 수 있는 좋은 기회였습니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="다음에도-라이브러리에-문제가-있다면">다음에도 라이브러리에 문제가 있다면?<a class="hash-link" href="#다음에도-라이브러리에-문제가-있다면" title="Direct link to heading">​</a></h2><p>결론부터 말하면 당장은 방법이 없습니다.</p><p>웹이었다면 stable 버전으로 바꿔서 배포하거나, fork하고 조금 수정해서 배포하면 됩니다. 하지만 앱이라면 문제가 다릅니다. hotfix가 불가능하기 때문이에요. 배포하기까지 심사를 거쳐야하고, 영업일 기준 1~2일이 소요됩니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="code-push">Code Push<a class="hash-link" href="#code-push" title="Direct link to heading">​</a></h3><p>React Native나 Flutter같은 하이브리드 앱의 장점 중 하나는 네이티브 앱에서는 불가능한 hotfix가 가능하다는 점입니다. 하지만 코드푸시도 네이티브 코드를 고치거나 패키지 버전 변경같이 설치할 때 진행되는 프로세스에 포함되는 코드는 수정할 수 없습니다. 즉, 코드푸시로도 라이브러리 오류 문제를 해결할 수 없습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="fs-모듈">fs 모듈<a class="hash-link" href="#fs-모듈" title="Direct link to heading">​</a></h3><p>노드 실행환경에는 기본 api들이 제공되는데, 그 중 fs라는 모듈이 있습니다. file system에 접근하게 해주는 모듈인데, 이 모듈로 런타임에 node_modules을 수정할 수 있지 않을까 생각해봤는데요, 생각해보니 앱을 설치하는 순간 앱은 node_modules를 각각 플랫폼에 맞는 형태로 변환합니다.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>플랫폼별 node_module 변환</h5></div><div class="admonition-content"><p>IOS → Pods</p><p>Android → AndroidX</p></div></div><p>그래서 런타임에는 node modules에 접근할 수 없습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="react-native-fs">react-native-fs<a class="hash-link" href="#react-native-fs" title="Direct link to heading">​</a></h3><p><a href="https://github.com/itinance/react-native-fs" target="_blank" rel="noopener noreferrer">react-native-fs</a>는 네이티브 코드 레벨에서 file system에 접근할 수 있게 해주는 라이브러리입니다. 안타깝게도 라이브러리와 직접 연관되어있는 <strong>Pods</strong>에는 접근이 되지 않는 것 같았고, Download 폴더, Library 폴더, Document 폴더 등에는 접근 가능한 것으로 확인했습니다. 이마저도 런타임에 파일을 고치기보다는 파일 업로드나 Native 레벨의 정적 asset에 접근하는 용도로 활용합니다.</p><p><img loading="lazy" alt="16" src="/getcha_frontend_docs/assets/images/16-8e00093315520b7eb68f0637d036e63a.png" width="390" height="330" class="img_E7b_"></p><p>이번에 방법을 찾았더라면 <strong>React Native</strong> + <strong>Code Push</strong>의 효과를 극대화할 수 있을 것이라 생각했는데 그렇지 못해 조금 아쉽긴 합니다. 두 플랫폼 다 node_modules라는 개념이 프리빌드 페이즈에서 사라진다는 점 때문에 런타임에 뭔가를 수정한다면 <code>react-native-fs</code> 뿐이긴 합니다면, 네이티브 코드가 수정되어 빌드되고 반영되는지를 확인을 해보지 못해서 아직 명확하지 않고 되더라도 네이티브 개발을 할 줄 알아야하니 그리 효율적인 방법 같지는 않습니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="의존성과-종속성에-대하여">의존성과 종속성에 대하여<a class="hash-link" href="#의존성과-종속성에-대하여" title="Direct link to heading">​</a></h2><p>이번 사태로 배운점이 있다면 <strong>의존성</strong>과 <strong>종속성</strong>을 조절하지 못하면 언젠가 문제가 생기고, 우리는 이에 대한 해결책을 가지고 있어야한다는 점입니다. 실제로 이번 라이브쇼 프로젝트는 자사 서비스가 아닌 제휴사와의 계약사항이었고 릴리즈 날짜가 픽스되어있는 작업이었는데, 사용하는 서드파티 라이브러리로 인해 정상 서비스를 할 수 없는 사태가 발생했을 때, 그 책임을 이 오픈소스가 짊어지지 않습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="큰-라이브러리도-틀릴-수-있다">큰 라이브러리도 틀릴 수 있다<a class="hash-link" href="#큰-라이브러리도-틀릴-수-있다" title="Direct link to heading">​</a></h3><p>이번에 문제가 되었던 라이브러리는 <a href="https://github.com/react-native-webview/react-native-webview" target="_blank" rel="noopener noreferrer">react-native-webview</a>입니다. 월 다운로드수가 150만이고, star는 4700개네요. 굉장히 크고 활발히 유지되는 라이브러리라 볼 수 있습니다.</p><p><img loading="lazy" alt="17" src="/getcha_frontend_docs/assets/images/17-f6917c2d78cca1028ff36f878e9764b7.png" width="2364" height="424" class="img_E7b_"></p><p>이 정도의 커다란 라이브러리에서도 장애가 발생합니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="뭐든-도입할-땐-신중하자">뭐든, 도입할 땐 신중하자<a class="hash-link" href="#뭐든-도입할-땐-신중하자" title="Direct link to heading">​</a></h3><p>우리는 개발공수를 줄이기 위해 라이브러리를 가져다 사용하곤 합니다. 라이브러리는 복잡한 기능을 간단히 <strong>모듈화</strong>해주고, <strong>관리해야할 코드를 줄여주는</strong> 장점을 가지고 있습니다.</p><p>하지만 어떤 문제를 야기할지 모릅니다. 그리고 문제가 발생했을 때 <strong>손을 쓸 수 있는 방법이 많이 없고</strong>, 그 문제를 발견하는데 오랜 시간이 걸릴 수 있습니다.</p><p>그러므로 새로운 라이브러리를 도입할 땐 팀원들 간의 합의가 필요하고, <strong>꼭 필요한지</strong> 검증하는 단계가 있어야하며 그렇지 않다면 최대한 <strong>안정적인 라이브러리들을 활용해서 구현</strong>해야한다고 생각합니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="핵심-기능은-우리-손에-있어야-한다">핵심 기능은 우리 손에 있어야 한다.<a class="hash-link" href="#핵심-기능은-우리-손에-있어야-한다" title="Direct link to heading">​</a></h3><p>각 서비스에서 코어 패키지가 있을겁니다. 가령 비디오 영상 플렛폼에서는 비디오 플레이어 라이브러리가 될 것이고, 쇼핑몰 앱에서는 그리드 뷰가 될 수 있겠습니다. getcha의 코어 패키지는 웹뷰와 탭뷰입니다.</p><p>이번 <code>react-native-webview</code>이슈와 비슷하게, <code>react-native-tab-view</code>도 오작동 이슈가 있었습니다. 메이져 업데이트를 하고나니 컨텐츠가 보이지 않는 치명적인 버그였습니다. 당장은 동작하도록 수습은 해두었지만, 이 부분은 아직도 레거시로 남아있습니다.</p><p>핵심 기능을 우리가 직접 구현하지 않으면, 이런 문제는 반복될 수밖에 없습니다. 저는 라이브러리를 가져다 사용하는 것 자체가 <strong>기술부채</strong>라고 생각합니다. 기술부채에서 <strong>부채</strong>라는 단어는 빚을 낸다는 뜻인데, 문제 해결을 위해 기술적으로 미래에 갚아야 할 빚을 만드는 것입니다. 나보다 훨씬 뛰어난 개발자가 나보다 더 잘 만든 패키지를 제공해준다는데 뭐가 문제냐 할 수도 있겠지만, 언제까지 그 개발자가 패키지를 유지해줄지는 보장할 수 없습니다.</p><p>물론 모든 기능을 최소한의 패키지만 사용해서 개발하는 것은 불가능에 가깝습니다. 하지만 그 선은 내부 합의로 정해야 하고, 같은 기능이라도 어떤 라이브러리를 사용할지에도 신중해야합니다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/getcha_frontend_docs/blog/tags/react-native">react-native</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/getcha_frontend_docs/blog/modal">겟차에서 모달을 컨트롤하는 방법</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-06-01T00:00:00.000Z" itemprop="datePublished">June 1, 2022</time> · <!-- -->15 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18079523?v=4" alt="Nick"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nick</span></a></div><small class="avatar__subtitle" itemprop="description">FrontEnd Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>안녕하세요. Getcha FrontEnd 개발자 <strong>Nick</strong>입니다.</p><p>UI / UX의 측면에서 interaction은 매우 중요한 부분을 차지합니다. 적재적소에 배치된 버튼이나 모달, 상황에 맞는 인터렉션은 사용자 이탈을 막고 서비스 내에서 사용자와 사업자가 원하는 화면까지 가도록 돕는 방법이기 때문입니다.</p><p>그 중에서 오늘 다뤄볼 주제는 모달(Modal)입니다.</p><h1>모달</h1><p>Modal은 User Interface 중 부모 화면의 윗 레이어에 위치해서 간단한 사용자 인터렉션을 진행하고 되돌아가도록 설계되어있는 모든 종류의 UI를 통칭합니다.</p><img loading="lazy" src="/getcha_frontend_docs/assets/images/modal_wiki-bb763e353a87c8e61310e85b6d6a2503.png" alt="Example banner" width="400" height="200" class="img_E7b_"><p>참조 : 위키백과</p><p>그 종류는 디자인 시스템에 따라, 플랫폼마다 종류가 다릅니다. 심지어 같은 UI인데 다르게 부르는 경우도 많아요.</p><p>저희는 디자인 시스템을 구축하기 전에 모달에 대해 정리하기로 하고, 이 기준을 모달의 <strong>성격</strong>으로 나눠보기로 했어요.</p><h1>구현</h1><hr><p>모달을 구현하는 방식은 정말 다양합니다. 그리고 방법마다 다양한 차이가 있습니다.</p><p>저희도 나름대로 기준을 가지고 모달을 구현해두었는데, 비효율성을 체감하고 이번 리팩토링 과정에서 다음의 기준으로 여러 방법을 모색하고, 가장 좋은 방법을 선택해서 구현하기로 했습니다.</p><ol><li>구현 &amp; 유지보수 난이도</li><li>효율 (리렌더링, 메모리 등)</li><li>사용 방법의 용이성</li></ol><p>물론 이런저런 생각 하지 말고 무지성으로 이쁘게 잘 만들어진 라이브러리를 가져다 사용하는 방법이 가장 효율적일 수도 있답니다.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="현재-상황">현재 상황<a class="hash-link" href="#현재-상황" title="Direct link to heading">​</a></h2><p>저희 Getcha Frontend Chapter에서는 모달을 종류로 나누고, 컨텐츠 단위로 컴포넌트를 하나씩 만들었어요. 모달의 활용이 너무 다양해지다보니 하나로 통일하지 못하고 BoilerPlate 코드를 기반으로 매번 복사 붙혀넣기로 찍어내고 있었습니다. 그래서 아래 예시와 같이 팝업이나 모달을 사용할 때마다 새로 만들어 사용하고 있었어요.</p><div class="codeBlockContainer_I0IT language-jsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-jsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// ex. ChooseAnotherFeatureModal.tsx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Container</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">TX.P16</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">isBold</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">lineHeight</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">24px</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        다른 기능을 선택하면</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">TX.P16</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">TX.P16</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">isBold</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">lineHeight</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">24px</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">        입력하신 내용이 삭제됩니다.</span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">TX.P16</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">Container</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">TwoBtn</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name" style="color:#00a4db">leftText</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">취소</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name" style="color:#00a4db">rightText</span><span class="token tag attr-value punctuation attr-equals" style="color:#393A34">=</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag attr-value" style="color:#e3116c">차량비교하기</span><span class="token tag attr-value punctuation" style="color:#393A34">&quot;</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name" style="color:#00a4db">handleLeftPress</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">handleLeftPress</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name" style="color:#00a4db">handleRightPress</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">handleRightPress</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name" style="color:#00a4db">leftBtnColor</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">Colors</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">base</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">grey300</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f">    </span><span class="token tag attr-name" style="color:#00a4db">leftTextColor</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">Colors</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">base</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript" style="color:#00009f">black</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"></span><br></span><span class="token-line" style="color:#393A34"><span class="token tag" style="color:#00009f"></span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>그저 팝업만 하나 켰다 끄고 싶을 뿐인데, 비슷한 파일이 하나 새로 생기는 일이 벌어진 것이죠. 상당히 비효율적입니다.</p><p>또한 이 모달을 컨트롤하려면, 이 모달을 호출하는 부모 뷰에서 이 컴포넌트를 선언해줘야하고, 켜고 끄는 State를 따로 만들어줘야합니다. 이 모달을 켜고 끌 때마다 리렌더링이 발생하는 것은 덤이고요.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="모달을-컨트롤하는-방법">모달을 컨트롤하는 방법<a class="hash-link" href="#모달을-컨트롤하는-방법" title="Direct link to heading">​</a></h2><p>모달을 켜고 끄는 방법은 다양합니다. 구현하기 나름이고 대부분 런타임에 큰 오버헤드 없이 동작합니다. 엄청난 계산을 요하는 동작은 아니니까요. 하지만 위에서 언급한 기준들을 고려해서 가장 좋은 방법을 찾아 수정하기로 했습니다. 다음 방법들을 살펴봅시다.</p><ol><li><p>호출하는 화면에 선언 후 내부 State로 호출</p><p>모달이 자주 쓰이지 않거나 프로젝트 크기가 작다면 대부분 이런 방식으로 활용할겁니다. 리팩토링 전엔 저희도 토스트 메시지를 제외한 모달들을 이와 같이 호출했습니다.</p><p>이 방법은 모달 간 의존도가 낮아 사이드이펙트가 거의 없다는 점입니다. 공통 컴포넌트로 사용하는 보일러플레이트 컴포넌트가 있긴 하지만, 그것만 잘 만들어두면됩니다.</p><p>단점은 간단한 팝업 하나 호출해도 파일을 하나 새로 만들어야 한다는 점입니다. 유지보수 난이도가 확 올라가죠. 간단한 수정에도 모든 파일을 고쳐야하니까요.</p></li><li><p>최상단에 선언 후 Store로 호출</p><p>미리 최상단에 공통 컴포넌트로 모달을 호출해두고 전역 상태 관리 라이브러리로 내부 컨텐츠와 모달의 visible 상태를 컨트롤하는 방법입니다.</p><p>하지만 이를 위해 Store를 구현해야하고, 저희같이 Redux를 사용한다면 벌써 짜증을 낼 수도 있어요. 사용성도 좋지 않아요. 그저 모달을 켜고 끄기 위해 디스패칭 함수를 호출해야하니까요. (일을 위한 일을 한다고 하죠.)</p><p>성능 이슈도 있습니다. 리렌더링마다 전역 Store가 변화하고, 이에 따라 연관된 컴포넌트들을 리렌더링 시키기 때문입니다.</p></li><li><p>최상단에 선언 후 Static 함수로 켜고 끄기</p><p>가장 이상적인 방법인데요. 2번과 비슷하지만 Dom Tree 전체를 리렌더링 시키지 않습니다.</p><p>단점은 Class Component밖에 사용할 수 없다는 점입니다. 사실 Functional Component에서 구현하는 방식은 아직 찾지 못했습니다.</p></li><li><p>Portal 활용</p><p>포탈을 활용하면 다른 루트에 컴포넌트를 렌더링할 수 있습니다. 현재 보이는 컴포넌트들과 다른 곳에 렌더링하기 때문에 컴포넌트 트리를 무너뜨리지 않고 모달을 켜고 끌 수 있는 것이죠.</p><p>켜고 끄는 방식은 2번과 유사합니다. Hook이나 Context를 활용하시면 됩니다.</p></li></ol><h3 class="anchor anchorWithStickyNavbar_mojV" id="비교">비교<a class="hash-link" href="#비교" title="Direct link to heading">​</a></h3><table><thead><tr><th></th><th>구현 &amp; 유지보수 난이도</th><th>효율</th><th>사용 방법의 용이성</th></tr></thead><tbody><tr><td>화면 내부 선언</td><td>매우 높음. 사용할 때마다 새 파일을 생성해줘야 합니다.</td><td>부모 컴포넌트가 State를 관리하기 때문에 켜고 끌 때마다 리렌더링 발생합니다.</td><td>매우 어려움. 사용 시 항상 파일을 만들어줘야하고, 선언해줘야 하며 켜고 끄는 state를 따로 만들어줘야해요.</td></tr><tr><td>Store 활용</td><td>스토어 관리를 해야해서 난이도가 조금 올라갑니다.</td><td>스토어 업데이트마다 리렌더링 발생합니다.</td><td>리덕스나 컨텍스트 API 를 활용해야해서 사용방법은 좋지 않습니다.</td></tr><tr><td>Static 함수 활용</td><td>Class Component로 구현해야 해서 유지보수가 힘들 수 있습니다.</td><td>내부 State로 관리하기 때문에 성능은 제일 좋습니다.</td><td>제일 간단하고 쉽습니다. import하고 method를 호출해주기만 하면 끝.</td></tr><tr><td>Portal 활용</td><td>커스텀 훅 관리로 인해 살짝 높습니다.</td><td>다른 Dom Tree 내에 생성되어 있기 때문에 리렌더링 이슈 없습니다.</td><td>컨텍스트나 훅을 활용해야해서 사용방법은 좋지 않습니다.</td></tr></tbody></table><p>결론적으로 저희는 3번. Static 함수를 활용해서 모달을 만들기로 했습니다. Class Component를 활용해야한다는 점만 제외하면 효율, 사용 방법의 용이성은 탁월했기 때문이에요.</p><p>1번 방식은 저희가 비효율을 느끼고 바꾸려는 방법이라 패스했습니다. 작은 프로젝트에는 의존성 문제도 없고 좋지만 저희처럼 서비스 크기가 켜지는 페이즈에서 차용하기엔 부적합하다고 결론지었습니다.</p><p>2번 방식은 Redux의 사용성 문제가 있었습니다. 어쨌건 리덕스에 의존해야 하거든요. 다른 스토어 라이브러리를 도입한다고 해도 그 라이브러리에 의존하게 됩니다. 스토어를 만들고, 이를 변경하는 과정이 모두 리소스 낭비처럼 느껴졌습니다.</p><p>4번 방식은 효율이 좋지만 일단 React Native에서 Portal을 지원하지 않습니다. 이를 위해 따로 서드파티 라이브러리를 활용하자니 의존성이 하나 더 생길 뿐이거든요. 또한 활용 방식 마저 스토어나 컨텍스트, 커스텀 훅을 활용해야하는지라 간단한 피봇팅 치고 큰 이점이 없었습니다.</p><p>그렇다면 3번 방식인 Static 함수를 활용한 모달은 어떻게 만드는지 알아볼게요.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="구현-방식">구현 방식<a class="hash-link" href="#구현-방식" title="Direct link to heading">​</a></h2><p>핵심 아이디어는, Class Component의 Static 메소드를 호출하고, 그 Static Method는 ref로 내부 method에 접근해서 state를 변경하는 방식입니다.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>javaScript에서 static 메소드는 class의 instance가 생성되기 전에 호출 가능합니다. instance를 만들게된다면 호출할 수 없어요.</p></div></div><p>단점이라고 한다면 유지보수가 조금 어려워진다는 점인데, 모두가 Functional Component를 사용하고 있는데 Class Component를 사용해야한다는 점이에요.</p><p>기본적으로 Functional Component에서는 static 메소드라는 개념이 없기 때문에 Class Component를 활용해요.</p><p>로딩 컴포넌트를 구현한 예시를 볼게요. 코드가 길어져서 interface나 styled component 객체는 전부 생략했습니다.</p><h2 class="anchor anchorWithStickyNavbar_mojV" id="예시1-loading-컴포넌트">예시1. Loading 컴포넌트<a class="hash-link" href="#예시1-loading-컴포넌트" title="Direct link to heading">​</a></h2><div class="codeBlockContainer_I0IT language-jsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-jsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Dimensions </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;react-native&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> React</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> Component </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;react&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> styled </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;styled-components/native&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> LottieLoading </span><span class="token keyword" style="color:#00009f">from</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;@Components/Screens/MyCarPrice/LottieLoading&#x27;</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">class</span><span class="token plain"> </span><span class="token class-name">Loading</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">extends</span><span class="token plain"> </span><span class="token class-name">Component</span><span class="token operator" style="color:#393A34">&lt;</span><span class="token plain">LoadingProps</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> LoadingState</span><span class="token operator" style="color:#393A34">&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    state </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> initialState</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> _ref </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setRef</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter">ref </span><span class="token parameter operator" style="color:#393A34">=</span><span class="token parameter"> </span><span class="token parameter keyword" style="color:#00009f">null</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Loading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_ref </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> ref</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Loading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_ref</span><span class="token operator" style="color:#393A34">?.</span><span class="token function" style="color:#d73a49">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Loading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_ref</span><span class="token operator" style="color:#393A34">?.</span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token keyword" style="color:#00009f">static</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token parameter literal-property property" style="color:#36acaa">props</span><span class="token parameter operator" style="color:#393A34">:</span><span class="token parameter"> LoadingProps</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        Loading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">_ref</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">props</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">timer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token function" style="color:#d73a49">setTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=&gt;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> </span><span class="token number" style="color:#36acaa">1000</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">clearTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timerID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">isLoading</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token function" style="color:#d73a49">clearTimeout</span><span class="token punctuation" style="color:#393A34">(</span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timerID</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain">initialState</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> status </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&#x27;loading&#x27;</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">setState</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> </span><span class="token literal-property property" style="color:#36acaa">isLoading</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token boolean" style="color:#36acaa">true</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> status </span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">timerID </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">timer</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token function" style="color:#d73a49">render</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> React</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">ReactNode </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">const</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain"> isLoading</span><span class="token punctuation" style="color:#393A34">,</span><span class="token plain"> status </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">=</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">this</span><span class="token punctuation" style="color:#393A34">.</span><span class="token plain">state</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">            </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">                </span><span class="token punctuation" style="color:#393A34">{</span><span class="token plain">isLoading </span><span class="token operator" style="color:#393A34">?</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">BackDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">                        </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">LottieLoading</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">status</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript" style="color:#00009f">status</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag" style="color:#00009f"> </span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag class-name" style="color:#00009f">BackDrop</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"> </span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">                </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain-text"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain-text">            </span><span class="token tag punctuation" style="color:#393A34">&lt;/</span><span class="token tag punctuation" style="color:#393A34">&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">        </span><span class="token punctuation" style="color:#393A34">)</span><span class="token punctuation" style="color:#393A34">;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">}</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">export</span><span class="token plain"> </span><span class="token keyword" style="color:#00009f">default</span><span class="token plain"> Loading</span><span class="token punctuation" style="color:#393A34">;</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h3 class="anchor anchorWithStickyNavbar_mojV" id="사용-방법">사용 방법<a class="hash-link" href="#사용-방법" title="Direct link to heading">​</a></h3><p>먼저 선언을 해줍니다. 앱의 최상단에 선언하고 이를 켰다 껐다 하는 방식으로 컨트롤할거에요.</p><div class="codeBlockContainer_I0IT language-jsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-jsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token comment" style="color:#999988;font-style:italic">// App.tsx</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token keyword" style="color:#00009f">return</span><span class="token plain"> </span><span class="token punctuation" style="color:#393A34">(</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token tag punctuation" style="color:#393A34">&lt;</span><span class="token tag class-name" style="color:#00009f">Loading</span><span class="token tag" style="color:#00009f"> </span><span class="token tag attr-name" style="color:#00a4db">ref</span><span class="token tag script language-javascript script-punctuation punctuation" style="color:#393A34">=</span><span class="token tag script language-javascript punctuation" style="color:#393A34">{</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript parameter" style="color:#00009f">ref</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript" style="color:#00009f"> </span><span class="token tag script language-javascript operator" style="color:#393A34">=&gt;</span><span class="token tag script language-javascript" style="color:#00009f"> Loading</span><span class="token tag script language-javascript punctuation" style="color:#393A34">.</span><span class="token tag script language-javascript function" style="color:#d73a49">setRef</span><span class="token tag script language-javascript punctuation" style="color:#393A34">(</span><span class="token tag script language-javascript" style="color:#00009f">ref</span><span class="token tag script language-javascript punctuation" style="color:#393A34">)</span><span class="token tag script language-javascript punctuation" style="color:#393A34">}</span><span class="token tag punctuation" style="color:#393A34">/&gt;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">    </span><span class="token operator" style="color:#393A34">...</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>그리고 Loading Class를 import 받으시고, static method를 호출해주기만 하면 로딩 화면이 최상단에 뜨게 됩니다.</p><div class="codeBlockContainer_I0IT language-jsx theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-jsx codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token keyword" style="color:#00009f">import</span><span class="token plain"> Loading form </span><span class="token string" style="color:#e3116c">&quot;Getcha-UI-Toolkit&quot;</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 로딩을 켤 때</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">show</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 로딩의 상태를 변경할 때</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">update</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">{</span><span class="token literal-property property" style="color:#36acaa">status</span><span class="token operator" style="color:#393A34">:</span><span class="token plain"> </span><span class="token string" style="color:#e3116c">&quot;success&quot;</span><span class="token punctuation" style="color:#393A34">}</span><span class="token punctuation" style="color:#393A34">)</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain"></span><span class="token comment" style="color:#999988;font-style:italic">// 로딩을 끌 때</span><span class="token plain"></span><br></span><span class="token-line" style="color:#393A34"><span class="token plain">Loading</span><span class="token punctuation" style="color:#393A34">.</span><span class="token function" style="color:#d73a49">close</span><span class="token punctuation" style="color:#393A34">(</span><span class="token punctuation" style="color:#393A34">)</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><h1>글을 마치며</h1><p>서두에서도 언급했듯 로딩 컴포넌트는 사용자 경험에 있어서 굉장히 중요한 지위를 갖는 UI입니다. 그만큼 자주 사용되고 수정도 빈번한 코드라는 뜻이기도 해요. 그 점에 있어 모달 구현의 <strong>일관성</strong>, <strong>개발 및 유지보수</strong>, <strong>성능 및 효율</strong>, <strong>사용 방식</strong>은 모두 굉장히 중요한 요소입니다.</p><p>팀 바이 팀, 개발자 바이 개발자로 이견이 있을 수 있지만 저희가 제시한 방법들 중 선호하는 방식으로 모달을 구현해보시면 좋을 것 같습니다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/getcha_frontend_docs/blog/tags/react-native">react-native</a></li></ul></div></footer></article><article class="margin-bottom--xl" itemprop="blogPost" itemscope="" itemtype="http://schema.org/BlogPosting"><header><h2 class="blogPostTitle_rzP5" itemprop="headline"><a itemprop="url" href="/getcha_frontend_docs/blog/team-blog">도큐사우루스를 활용한 겟차 프론트엔드 팀 사이트 만들기</a></h2><div class="blogPostData_Zg1s margin-vert--md"><time datetime="2022-04-24T00:00:00.000Z" itemprop="datePublished">April 24, 2022</time> · <!-- -->12 min read</div><div class="margin-top--md margin-bottom--sm row"><div class="col col--6 authorCol_FlmR"><div class="avatar margin-bottom--sm"><span class="avatar__photo-link avatar__photo"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer"><img class="image_o0gy" src="https://avatars.githubusercontent.com/u/18079523?v=4" alt="Nick"></a></span><div class="avatar__intro" itemprop="author" itemscope="" itemtype="https://schema.org/Person"><div class="avatar__name"><a href="https://github.com/hojunin" target="_blank" rel="noopener noreferrer" itemprop="url"><span itemprop="name">Nick</span></a></div><small class="avatar__subtitle" itemprop="description">FrontEnd Developer</small></div></div></div></div></header><div class="markdown" itemprop="articleBody"><p>안녕하세요. Getcha FrontEnd 개발자 <strong>Nick</strong>입니다. 오늘은 페이스북의 정적 문서 생성 프레임워크인 도큐사우르스를 활용한 겟차 프론트엔드 팀 웹사이트 빌딩 과정을 소개하겠습니다.</p><p>저희 프론트엔드 팀은 이미 엄청나게 커진 겟차의 메인 <strong>서비스 프로젝트 크기를 줄이는 목적</strong>을 가진 리팩토링의 일환으로 <em>컴포넌트 라이브러리</em>를 만들기로 했어요. 프로덕트 디자인 팀 또한 <strong>디자인 가이드</strong>를 제작중이기에 이에 발맞춘 스텝이기도 해요.</p><p>디자인 팀은 <a href="https://zeroheight.com/" target="_blank" rel="noopener noreferrer">zeroHeight를</a> 활용한 <a href="https://socarframe.socar.kr/8bb3aba4a/p/480a5e-introduction" target="_blank" rel="noopener noreferrer">쏘카의 디자인 템플릿</a>을 참고한다고 해서 프론트 챕터는 문서를 따로 만들지 말까도 생각했지만, 저희는 로직에 집중한 컴포넌트 라이브러리면서 전반적인 프론트엔드 개발 가이드를 제공하는 설명 문서가 필요했기에 제작하기로 했습니다. 그래서 다음의 <strong>목적</strong>들을 달성할 수 있는 사이트를 만들기로 했습니다.</p><ol><li>Getcha FrontEnd 개발 가이드 정립</li><li>Ghetcha Components Library Docs</li><li>FrontEnd Tech Blog</li><li>홍보 (<strong>개발자님들 많이 지원해주세요 !!</strong> 😆😆)</li></ol><p>처음엔 개츠비나 깃북같은 유명한 정적 문서 생성 프레임워크들을 생각했습니다. 아예 블로그를 시작부터 빌딩할 수준의 크기라고 생각해서였어요. 하지만 개발 리소스는 서비스 유지를 하기에도 바빴기 때문에 개발비용을 최소화해서 이런 수준의 사이트를 만들 수 있는 프레임워크인 <strong>도큐사우루스</strong>를 활용하기로 결정했습니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="도큐사우루스란">도큐사우루스란?<a class="hash-link" href="#도큐사우루스란" title="Direct link to heading">​</a></h2><p>도큐사우루스는 facebook에서 개발한 React 기반 <strong>정적 페이지 프레임워크</strong>입니다.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>도큐사우루스 방문하기</h5></div><div class="admonition-content"><p>💡 <a href="https://docusaurus.io/ko/" target="_blank" rel="noopener noreferrer">도큐사우루스</a> 공식 홈페이지</p></div></div><p>도큐사우루스의 목적은 정말 심플하고 강력합니다. 아래 사진은 도큐사우루스 메인페이지에 나온 슬로건인데요. 이 한 문장 안에 도큐사우루스의 모든게 담겨있다고 볼 수 있습니다.</p><p><img loading="lazy" alt="스크린샷 2022-04-23 오후 7.52.57.png" src="/getcha_frontend_docs/assets/images/docusaurus-slog-ab417ecbfa7ce257bc9abf2670d78ba0.png" width="2202" height="438" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="특징">특징<a class="hash-link" href="#특징" title="Direct link to heading">​</a></h3><p>도큐사우루스는 개츠비와 같이 이미 자주 사용되던 정적 페이지 생성기들과 다른 몇가지 특징이 있습니다.</p><ol><li><p>콘텐츠만 신경써도 될 정도로 간단하다.</p><p>간단히 프로젝트만 만들어도, 당장 사용해도 될 만큼 <strong>완성도 높은</strong> 사이트가 나오고, <strong>커스터마이징</strong>도 간단합니다.
SEO나 i18n 국제화, 검색, 다크모드 같이 없으면 불편한 기능들이 전부 <strong>기본으로</strong> 제공됩니다.</p></li><li><p>폴더 구조가 직관적이고 단순하다.</p><p>하나의 상단 탭이 하나의 폴더이고, 그 하위에 모든 .md 파일이 위치하는 구조입니다.
페이지 구성이 폴더 구조와 비슷해서 관리하기 용이합니다.</p></li><li><p>Mdx 파일 지원</p><p>markdown 파일은 서식이 있는 텍스트에요. 마치 옷을 입은 .txt파일이랄까요. mdx는 고작 텍스트 파일에서 jsx를 사용하게 해주는 놀라운 기능입니다.</p></li><li><p>다양한 플러그인 지원</p><p><a href="https://docusaurus.io/ko/docs/api/plugins" target="_blank" rel="noopener noreferrer">다양한 플러그인</a>을 통해 커스터마이징이 가능합니다. 성가신 설정도 도큐사우루스에서 해주기 때문에 저희는 간단히 가져다 사용하기만 하면 된답니다.</p></li></ol><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>마지막 특징</h5></div><div class="admonition-content"><p>!! 5. (마스코트 공룡🦖이 <strong>매우</strong> 귀엽다)</p></div></div><p>제가 처음 사용해보고 느낀점은 거의 모든 틀이 <strong>정해져있고</strong> 저희는 정말 <strong>콘텐츠만</strong> 넣어서 빌드하면 완벽한 웹사이트가 나오는 느낌이었습니다. 리액트 기반 프레임워크다보니 커스터마이징도 매우 쉽다는 장점도 있었구요.</p><p>이제 프로젝트 생성부터 진행해보겠습니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="프로젝트-생성하기">프로젝트 생성하기<a class="hash-link" href="#프로젝트-생성하기" title="Direct link to heading">​</a></h2><p>먼저 준비할 것은 <strong><em>14</em></strong> 버전 이상의 Node.js입니다.</p><p>터미널을 열고, 다음 명령어를 입력해줍니다.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token plain">npx create-docusaurus@latest my-website classic --typescript</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>도큐사우루스 <strong>최신버전</strong>(2.xx beta)으로 my-website라는 <strong>이름의 프로젝트</strong>를, <strong>classic</strong> 플러그인(도큐사우루스 권장 플러그인)과 <strong>타입스크립트</strong> 버전으로 생성하는 명령어입니다.</p><p><img loading="lazy" alt="스크린샷 2022-04-22 오후 10.32.01.png" src="/getcha_frontend_docs/assets/images/create-docusaurus-e08bf0ba2abccdc3bbd7ed73f219d795.png" width="1288" height="616" class="img_E7b_"></p><p>잘 생성되었으면 해당 프로젝트로 들어가서, 다음 명령어를 통해 프로젝트를 실행시킵니다.</p><div class="codeBlockContainer_I0IT language-bash theme-code-block"><div class="codeBlockContent_wNvx" style="color:#393A34;background-color:#f6f8fa"><pre tabindex="0" class="prism-code language-bash codeBlock_jd64 thin-scrollbar"><code class="codeBlockLines_mRuA"><span class="token-line" style="color:#393A34"><span class="token function" style="color:#d73a49">yarn</span><span class="token plain"> start</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" title="Copy" class="copyButton_eDfN clean-btn"><span class="copyButtonIcons_W9eQ" aria-hidden="true"><svg class="copyButtonIcon_XEyF" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_i9w9" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div><p>그리고 결과물을 확인하면 아래 사진과 같습니다.</p><p><img loading="lazy" alt="짠" src="/getcha_frontend_docs/assets/images/docusaurus-done-04d70e37f6bae10ea8bf154ae6ac0eb3.png" width="3248" height="2112" class="img_E7b_"></p><p>보이는 것 처럼 시작부터 거의 완성된 도큐먼트 친화적인 홈페이지가 나옵니다. 👍🏻</p><hr><h3 class="anchor anchorWithStickyNavbar_mojV" id="docusaurusconfigjs">docusaurus.config.js<a class="hash-link" href="#docusaurusconfigjs" title="Direct link to heading">​</a></h3><p>docusaurus.config.js는 이 프로젝트의 설정이 담긴, 이 프로젝트 폴더에서 가장 중요한 파일입니다. 헤더나 탭, 푸터 구성 및 전체 테마, 플러그인 등 이 프로젝트에서 쓰이는 모든 설정을 이 파일에서 합니다.</p><p><img loading="lazy" alt="docusaurus.config.js" src="/getcha_frontend_docs/assets/images/config-fbe7d7b6671a87ea847cf2cceadb29dc.png" width="807" height="646" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="커스터마이징">커스터마이징<a class="hash-link" href="#커스터마이징" title="Direct link to heading">​</a></h3><p>위에서 설명한 docusaurus.config.js에서 간단히 테마와 글로벌 스타일 등을 변경하면, 다음과 같이 잘 만들어진 팀 블로그같은 사이트가 만들어집니다.</p><p><img loading="lazy" alt="after customizing" src="/getcha_frontend_docs/assets/images/after-custom-baa26374f42058fe07d3f3233d09fbe6.png" width="2980" height="1516" class="img_E7b_"></p><p>이로써 원했던 모습의 사이트가 완성되었습니다. 물론 디자이너님에게 부탁드려서 더 이쁘게 꾸며달라고 요청해야겠지만, 일단은 기능은 하니까. 목적은 달성입니다.</p><p>이제 글을 쓰러 가봅시다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="문서">문서<a class="hash-link" href="#문서" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_mojV" id="문서를-작성하기">문서를 작성하기<a class="hash-link" href="#문서를-작성하기" title="Direct link to heading">​</a></h3><p>문서를 작성하는 방법은 정말 간단합니다.</p><p>문서가 작성되길 원하는 폴더에 .md파일을 만들고 마크다운으로 작성합니다.</p><p>저장하면 어이없을 만큼 간단하게 문서가 생성되어 있습니다. 그 다음은 결과를 확인하고 배포하면 끝입니다.</p><div class="admonition admonition-tip alert alert--success"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="12" height="16" viewBox="0 0 12 16"><path fill-rule="evenodd" d="M6.5 0C3.48 0 1 2.19 1 5c0 .92.55 2.25 1 3 1.34 2.25 1.78 2.78 2 4v1h5v-1c.22-1.22.66-1.75 2-4 .45-.75 1-2.08 1-3 0-2.81-2.48-5-5.5-5zm3.64 7.48c-.25.44-.47.8-.67 1.11-.86 1.41-1.25 2.06-1.45 3.23-.02.05-.02.11-.02.17H5c0-.06 0-.13-.02-.17-.2-1.17-.59-1.83-1.45-3.23-.2-.31-.42-.67-.67-1.11C2.44 6.78 2 5.65 2 5c0-2.2 2.02-4 4.5-4 1.22 0 2.36.42 3.22 1.19C10.55 2.94 11 3.94 11 5c0 .66-.44 1.78-.86 2.48zM4 14h5c-.23 1.14-1.3 2-2.5 2s-2.27-.86-2.5-2z"></path></svg></span>tip</h5></div><div class="admonition-content"><p>저는 노션으로 편하게 작성해서 복사 &amp; 붙혀넣기 방식으로 작성합니다. 다른 .md 에디터는 안되더라구요.</p></div></div><p>아래에서 문서의 종류에 대해 알아보고 원하는 루트에 문서를 작성해보도록 해요.</p><p>도큐사우루스에서 문서는 두가지 타입으로 구성되어 있고, 각각 커스터마이징 하는 방법이 약간 다릅니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="1-docs">1. Docs<a class="hash-link" href="#1-docs" title="Direct link to heading">​</a></h3><p><img loading="lazy" alt="스크린샷 2022-04-23 오후 12.29.04.png" src="/getcha_frontend_docs/assets/images/docs-659779483f42b951f7ad6d9ba0a1f1a8.png" width="2674" height="1632" class="img_E7b_"></p><p>Docs는 전형적인 Document입니다. .md파일로 작성되어 있고, 위에서 언급했듯이 노션이나 타이포라같은 편집기로 편하게 작성한 뒤 복사&amp;붙혀넣기로 손쉽게 게시글을 작성할 수 있습니다.</p><p>작성된 글은 좌측 사이드바에서 네비게이팅 가능하고, 우측에서는 Heading type단위로 목차가 만들어집니다.</p><p>아래 좌우 페이지네이션도 제공합니다.</p><hr><h3 class="anchor anchorWithStickyNavbar_mojV" id="2-blog">2. Blog<a class="hash-link" href="#2-blog" title="Direct link to heading">​</a></h3><p>블로그 기능도 페이지마다 .md파일로 렌더링된다는 점에서 비슷하고 좌우 네비게이팅이나 인덱스가 만들어진다는 점에서도 Docs와 비슷합니다.</p><p><img loading="lazy" alt="스크린샷 2022-04-23 오후 12.31.15.png" src="/getcha_frontend_docs/assets/images/blog-d264a704344db016380e8390f0ca5b1e.png" width="2560" height="1430" class="img_E7b_"></p><p>아래의 기능들은 블로그에만 있는 기능들로 이마저도 개발이 필요없는 수준으로 제공되고 있습니다.</p><h3 class="anchor anchorWithStickyNavbar_mojV" id="작성자--태그-기능">작성자 &amp; 태그 기능<a class="hash-link" href="#작성자--태그-기능" title="Direct link to heading">​</a></h3><p>author를 .yml config파일로 관리합니다. 물론 이 문서 내에서 관리되지 않는 사람도 프로필을 등록할 수 있지만 이 파일에서 관리되고 있는 사람은 Key 값으로 간단히 사람 정보를 가져올 수 있습니다.</p><p><img loading="lazy" alt="스크린샷 2022-04-23 오후 8.35.48.png" src="/getcha_frontend_docs/assets/images/authors-127700ffb435b7aef1c9fa1a04d4fcb7.png" width="538" height="421" class="img_E7b_"></p><p>아래는 블로그 게시글 작성 파일인데 authors에서 Key값으로 간단하게 저자 정보를 가져오는 것을 볼 수 있습니다.</p><p><img loading="lazy" alt="스크린샷 2022-04-23 오후 8.36.59.png" src="/getcha_frontend_docs/assets/images/createTag-8ba20c3165109451b37cd822df9d54bc.png" width="652" height="341" class="img_E7b_"></p><h3 class="anchor anchorWithStickyNavbar_mojV" id="글-정보-및-작성자-컴포넌트">글 정보 및 작성자 컴포넌트<a class="hash-link" href="#글-정보-및-작성자-컴포넌트" title="Direct link to heading">​</a></h3><p>이 컴포넌트에선 글이 쓰여진 <strong>날짜</strong>, 이 글을 읽는데 <strong>얼마나 걸릴 것 같은지</strong>와 <strong>작성자</strong> 정보를 제공합니다.</p><p><img loading="lazy" alt="스크린샷 2022-04-23 오후 8.34.58.png" src="/getcha_frontend_docs/assets/images/author-component-dec0da59a2b55f932a1e4a26b9bea9b2.png" width="1462" height="214" class="img_E7b_"></p><p>또한 위 사진에서 tag array를 받는데, 나중에 해당 태그를 가진 게시글들만 모아서 볼 수 있는 기능도 제공합니다.</p><hr><h2 class="anchor anchorWithStickyNavbar_mojV" id="한계점">한계점<a class="hash-link" href="#한계점" title="Direct link to heading">​</a></h2><ul><li><p>글을 작성하는게 그렇게 쉽지만은 않습니다. 비교대상이 다른 블로그 게시글 에디터이다 보니 그런 것 같습니다.</p></li><li><p>내가 사용하는 마크다운 편집기에는 있는데 마크다운으로 지원하지 않는 서식이 있을 땐 그냥 나와버립니다. 이런 부분들은 일일이 찾아서 고쳐줘야 합니다.</p></li><li><p>블로그의 경우 Feed밖에 지원하지 않아서 카테고라이징을 Tag로 밖에 할 수 없습니다. 글이 많아지면 관리가 힘들 것 같더라구요.</p></li></ul><p>감사합니다.</p></div><footer class="row docusaurus-mt-lg"><div class="col"><b>Tags:</b><ul class="tags_XVD_ padding--none margin-left--sm"><li class="tag_JSN8"><a class="tag_hD8n tagRegular_D6E_" href="/getcha_frontend_docs/blog/tags/blog">blog</a></li></ul></div></footer></article><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></main></div></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">겟차 서비스</div><ul class="footer__items"><li class="footer__item"><a href="https://m.getcha.kr/" target="_blank" rel="noopener noreferrer" class="footer__link-item">겟차<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://hojunin.github.io/react-query-kr/" target="_blank" rel="noopener noreferrer" class="footer__link-item">리액트 쿼리 번역 프로젝트<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">동료를 찾아요!</div><ul class="footer__items"><li class="footer__item"><a href="https://www.wanted.co.kr/wd/100800" target="_blank" rel="noopener noreferrer" class="footer__link-item">지원하러 가기<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_I5OW"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 Getcha Frontend Chapter</div></div></div></footer></div>
<script src="/getcha_frontend_docs/assets/js/runtime~main.ded042b8.js"></script>
<script src="/getcha_frontend_docs/assets/js/main.f94d607f.js"></script>
</body>
</html>